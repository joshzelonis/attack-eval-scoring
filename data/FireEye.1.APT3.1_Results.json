{"T1085": {"TechniqueName": "Rundll32", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Enrichment": "The capability enriched rundll32.exe with an alert for Rundll32 Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1085 - Rundll32) and Tactics (Defense Evasion, Execution)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified use of rundll32.exe to execute update.dat with command-line arguments. [FE5]"}], "Screenshots": {"FE-1.A.1-3.png": "Enrichment of rundll32.exe execution (tagged with correct ATT&CK Technique, T1085 - Rundll32, and Tactics, Defense Evasion, Execution)", "FE-1.A.1-6.png": "Excerpt from the Managed Defense Report indicating rundll32.exe was used for execution (Specific Behavior)", "": ""}}}}, "T1064": {"TechniqueName": "Scripting", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "DetectionCategories": [{"Telemetry": "Telemetry showed Resume Viewer.exe spawning the child process cmd.exe to launch pdfhelper.cmd."}], "Screenshots": {"FE-1.A.1-2.png": "Telemetry showing the child cmd.exe process running the pdfhelper.cmd script", "": ""}}, "11.A.1": {"Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for Suspicious PowerShell Usage (Methodology) indicating powershell.exe ran with unusual arguments due to the -enc and -noP command-line arguments. The alert was mapped to a related ATT&CK Technique (T1086 - PowerShell) and the correct Tactic (Execution) and captured the encoded command. "}, {" Enrichment": " The capability enriched wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was tagged with the correct ATT&CK Technique (T1064 - Scripting) and Tactic (Execution). "}, {" Indicator of Compromise": " An Indicator of Compromise alert was generated for EMPIRE RAT (Backdoor) based on a detected string specific to the backdoor. The alert was also mapped to a related ATT&CK Technique (T1086 - PowerShell)."}], "Screenshots": {"FE-11.A.1-2.png": "Specific Behavior alert for Suspicious PowerShell Usage showing powershell.exe execution (tagged with related ATT&CK Technique, T1086 - PowerShell, and correct Tactic, Execution)", "FE-11.A.1-3.png": "Additional details on Specific Behavior alert for Suspicious PowerShell Usage", "FE-11.A.1-1.png": "Enrichment of wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T064 - Scripting, and Tactic, Execution)", "FE-11.A.1-4.png": "Indicator of Compromise alert for EMPIRE RAT (tagged with related ATT&CK Technique, T1086 - PowerShell)", "": ""}}, "12.E.1": {"Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "DetectionCategories": [{"Enrichment ": "The capability enriched powershell.exe with an alert for PowerShell Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1086 - PowerShell). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that a PowerShell command was run from the Empire process. [FE5]"}], "Screenshots": {"FE-12.E.1-1.png": "Enrichment of powershell.exe with PowerShell Execution alert (tagged with related ATT&CK Technique T1086 - PowerShell)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating a PowerShell command was run from Empire (Specific Behavior)", "": ""}}}}, "T1204": {"TechniqueName": "User Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "DetectionCategories": [{"General Behavior, Configuration Change": "A General Behavior alert was generated for the Resume Viewer.exe file due to it being labeled as malicious by a machine learning engine. The alert was generated after a configuration change of the file size limit for the machine learning engine. [FE1][FE2] "}, {" Telemetry": " Telemetry showed Resume Viewer.exe executing with a parent process of explorer.exe."}], "Screenshots": {"FE-1.A.1-1.png": "General Behavior alert showing Resume Viewer.exe labeled as Malware (alert triggered after configuration change)", "FE-1.A.1-5.png": "Telemetry showing Resume Viewer.exe being executed by explorer.exe", "": ""}}}}, "T1060": {"TechniqueName": "Registry Run Keys / Startup Folder", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"1.B.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "DetectionCategories": [{"Telemetry": "Telemetry showed autoupdate.bat being written to the Startup folder.[FE50]"}, {" Enrichment": " The capability enriched the file write of autoupdate.bat to the Startup folder by categorizing it as Persistence."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the backdoor persisted by executing autoupdate.bat at system start due to its presence in the Startup directory.[FE5]"}], "Screenshots": {"FE-1.B.1-1.png": "Telemetry showing autoupdate.bat file written to the Startup folder", "FE-1.B.1-2.png": "Enrichment of autoupdate.bat being written to Startup with Persistence category", "FE-1.B.1-3.png": "Additional details on enrichment of autoupdate.dat", "FE-1.B.1-4.png": "Excerpt from the Managed Defense Report indicating the backdoor persisted via autoupdate.bat being written to the Startup directory (Specific Behavior)", "": ""}}, "10.A.1": {"Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Enrichment": "The capability enriched cmd.exe executing a file from Startup with an alert for Process Execution Startup. The alert was also tagged with the correct ATT&CK Technique (T1060 - Registry Run Keys / Startup Folder) and Tactic (Persistence)."}, {"Telemetry": " Telemetry showed cmd.exe executing autoupdate.bat from the Startup folder."}, {" Telemetry, Tainted ": " Telemetry showed rundll32.exe executing update.dll with command-line arguments. The telemetry was tainted by the parent alert for Rundll32 Execution (Weak Signal). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that autoupdate.bat persisted due to its presence in the startup directory. [FE5]"}], "Screenshots": {"FE-10.A.1-1.png": "Enrichment of cmd.exe executing from Startup with Process Execution Startup alert (tagged with correct ATT&CK Technique, T1060 - Registry Run Keys / Startup Folder and Tactic, Persistence)", "FE-10.A.1-2.png": "Telemetry showing cmd.exe executing autoupdate.bat from Startup folder", "FE-10.A.1-3.png": "Telemetry showing rundll32.exe executing update.dat (tainted by parent Rundll32 Execution alert)", "FE-10.A.1-4.png": "Additional details of rundll32.exe telemetry", "FE-10.A.1-5.png": "Excerpt from the Managed Defense Report indicating autoupdate.bat persisted due to its presence in startup (Specific Behavior)", "": ""}}}}, "T1043": {"TechniqueName": "Commonly Used Port", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using port 53", "DetectionCategories": [{"Telemetry": "Telemetry showed port 53 command and control traffic."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it observed the use of UDP port 53 for DNS command and control traffic. [FE5]"}], "Screenshots": {"FE-1.C.1-1.png": "Telemetry showing port 53 command and control traffic", "FE-1.C.1-4.png": "Excerpt from the Managed Defense Report indicating command and control occurred over UDP port 53 (Specific Behavior)", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use port 80", "DetectionCategories": [{"Telemetry ": "Telemetry showed a connection over port 80 to 192.168.0.4 (C2 server). "}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain).\u00a0[FE5]\u00a0"}], "Screenshots": {"FE-6.B.1-1.png": "Telemetry showing port 80 connections to 192.168.0.4 (C2 server)", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using port 443", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed powershell.exe communicating over TCP port 443. The telemetry was tainted by the parent PowerShell Network Connection alert."}, {"General Behavior,Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor communicated with 192.168.0.5 (C2 server) over port 443.[FE5]"}], "Screenshots": {"FE-11.B.1-1.png": "Telemetry showing powershell.exe communicating over TCP port 443 (tainted by parent PowerShell Network Connection alert)", "FE-11.B.1-3.png": "Excerpt from the Managed Defense Report indicating Empire communicated over port 443 (General Behavior)", "FE-11.B.1-4.png": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 443 (General Behavior)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed a connection to freegoogleadsenseinfo.com (C2 domain) over TCP port 8080. The telemetry was tainted by the parent PowerShell URL Request (Weak Signal) alert."}, {"General Behavior,Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire instance communicated with freegoogleadsenseinfo.com (C2 domain) over port 8080.[FE5]"}], "Screenshots": {"FE-14.A.1-4.png": "Telemetry showing TCP port 8080 connection to freegoogleadsenseinfo.com (C2 domain) (tainted by parent PowerShell URL Request alert)", "FE-14.A.1-9.png": "Excerpt from the Managed Defense Report indicating Empire communicated over port 8080 (General Behavior)", "FE-11.B.1-4.png": "Additional excerpt from the Managed Defense Report indicating Empire was configured to communicate over port 8080 (General Behavior)", "": ""}}}}, "T1132": {"TechniqueName": "Data Encoding", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "DetectionCategories": [{"Telemetry,Tainted": "Telemetry showed base64-encoded DNS requests to freegoogleadsenseinfo.com (C2 domain). The telemetry was tainted by the parent Cobalt Strike DNS Beacon alert."}], "Screenshots": {"FE-1.C.1-2.png": "Telemetry showing encoded DNS requests (tainted by parent Cobalt Strike DNS Beacon alert)", "": ""}}}}, "T1071": {"TechniqueName": "Standard Application Layer Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Indicator of Compromise": "An Indicator of Compromise alert was generated for the hardcoded DNS record name syntax in the DNS lookups for freegoogleadsenseinfo.com (C2 domain). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control). "}, {"Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that command and control occurred via DNS. [FE5]"}], "Screenshots": {"FE-1.C.1-2.png": "Indicator of Compromise alert for DNS lookups (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)", "FE-1.C.1-5.png": "Excerpt from the Managed Defense Report indicating command and control occurred via DNS (Specific Behavior)", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry ": "Telemetry showed HTTP GET requests over port 80 to 192.168.0.4 (C2 server). "}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified C2 communication over HTTP to www.freegoogleadsenseinfo.com (C2 domain). [FE5]\u00a0"}], "Screenshots": {"FE-6.B.1-3.png": "Telemetry showing HTTP GET requests to 192.168.0.4 (C2 server)", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over HTTP to www.freegoogleadsenseinfo.com (C2 domain) (General Behavior)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"General Behavior,Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]"}], "Screenshots": {"FE-11.B.1-4.png": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "DetectionCategories": [{"Enrichment": "The capability enriched a HTTP GET request with an alert for PowerShell URL Request (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1071 - Standard Application Layer Protocol) and Tactic (Command and Control)."}], "Screenshots": {"FE-14.A.1-4.png": "Enrichment of HTTP GET request with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1071 - Standard Application Layer Protocol, and Tactic, Command and Control)", "": ""}}}}, "T1059": {"TechniqueName": "Command-Line Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.3": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "6.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "7.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.F.1": {"Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00a0", "DetectionCategories": [{"Enrichment": "The capability enriched cmd.exe spawning wscript.exe with an alert for Wscript Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution). Alert details showed that the context of the user was changed to Kmitnick."}, {" Telemetry": " Telemetry showed cmd.exe executing autoupdate.vbs with a parent process of powershell.exe."}], "Screenshots": {"FE-16.F.1-1.png": "Enrichment of cmd.exe spawning wscript.exe with Wscript Execution alert (tagged with correct ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)", "FE-16.F.1-2.png": "Telemetry showing cmd.exe executing autoupdate.vbs", "": ""}}}}, "T1016": {"TechniqueName": "System Network Configuration Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.A.1": {"Procedure": "Cobalt Strike: 'ipconfig /all' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that ipconfig.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]"}], "Screenshots": {"FE-2.A.1-1.png": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating ipconfig.exe was used to enumerate the network configuration of Nimda (Specific Behavior)", "FE-2.A.1-4.png": "Excerpt from the Managed Defense Report with additional details about ipconfig.exe execution", "": ""}}, "2.A.2": {"Procedure": "Cobalt Strike: 'arp -a' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched arp.exe with an alert for Arp Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that arp.exe was one of the reconnaissance commands performed to enumerate the network configuration of Nimda. [FE5]"}], "Screenshots": {"FE-2.A.1-2.png": "Enrichment of arp.exe with Arp Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating arp.exe was used to enumerate the network configuration of Nimda (Specific Behavior)", "FE-2.A.1-5.png": "Excerpt from the Managed Defense Report with additional details about arp.exe execution", "": ""}}, "4.B.1": {"Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched netsh.exe with an alert for Netsh Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1063 - Security Software Discovery) and the correct Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that netsh was a reconnaissance command used to obtain network configuration and the configuration profile of the Windows Firewall. [FE5]"}], "Screenshots": {"FE-4.B.1-1.png": "Enrichment of netsh.exe with Netsh Execution alert (tagged with related ATT&CK Technique, T1063 - Security Software Discovery, and correct Tactic, Discovery)", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating netsh was used to obtain network configuration and the configuration profile of the Windows Firewall (Specific Behavior)", "FE-4.B.1-2.png": "Excerpt from the Managed Defense Report with additional details about netsh", "": ""}}, "12.A.1": {"Procedure": "Empire: 'route print' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched route.exe with an alert for Route Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery). "}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified route.exe as a reconnaissance command used.[FE5]"}], "Screenshots": {"FE-12.A.1-1.png": "Enrichment of route.exe with Route Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating route.exe was a reconnaissance command used (General Behavior)", "": ""}}, "12.A.2": {"Procedure": "Empire: 'ipconfig /all' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched ipconfig.exe with an alert for Ipconfig Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery) and Tactic (Discovery). "}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified ipconfig.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.A.2-1.png": "Enrichment of ipconfig.exe with Ipconfig Execution alert (tagged with correct ATT&CK Technique, T1016 - System Network Configuration Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating ipconfig.exe was a reconnaissance command used (General Behavior)", "": ""}}, "12.E.1.11": {"Procedure": "Empire: WinEnum module included enumeration of network adapters", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1033": {"TechniqueName": "System Owner/User Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.B.1": {"Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "DetectionCategories": [{"Telemetry": "Telemetry showed the use of echo with command-line arguments. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that echo was one of the commands used to enumerate the current username. [FE5]"}], "Screenshots": {"FE-2.B.1-1.png": "Telemetry showing echo with command-line arguments", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating echo was used to enumerate the current username (Specific Behavior)", "FE-2.B.1-3.png": "Excerpt from the Managed Defense Report with additional details about echo", "": ""}}, "12.B.1": {"Procedure": "Empire: 'whoami /all /fo list' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery). "}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified whoami.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.B.1-1.png": "Enrichment of whoami.exe with Whoami Execution (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating whoami.exe was a reconnaissance command used (General Behavior)", "": ""}}, "12.E.1.1": {"Procedure": "Empire: WinEnum module included enumeration of user information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "20.B.1": {"Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed whoami.exe executing from magnify.exe within an alert for Accessibility Features Child Process. The telemetry was tainted by the Accessibility Features Child Process (METHODOLOGY) alert. "}, {" Enrichment": " The capability enriched whoami.exe with an alert for Whoami Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1033 - System Owner/User Discovery) and Tactic (Discovery)."}], "Screenshots": {"FE-20.A.1-5.png": "Telemetry showing whoami.exe executing as a child process of magnify.exe (tainted by parent Accessibility Features Child Process alert)", "FE-20.A.1-6.png": "Enrichment of whoami.exe with Whoami Execution alert (tagged with correct ATT&CK Technique, T1033 - System Owner/User Discovery, and Tactic, Discovery)", "": ""}}}}, "T1106": {"TechniqueName": "Execution through API", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "3.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1057": {"TechniqueName": "Process Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.C.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "Cobalt Strike: 'tasklist /v' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched tasklist.exe with an alert for Tasklist Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed ": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that tasklist was one of the commands used to enumerate current running processes. [FE5]"}], "Screenshots": {"FE-2.C.2-1.png": "Enrichment of tasklist.exe with Tasklist Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating tasklist was used to enumerate current running processes (Specific Behavior)", "FE-2.C.2-2.png": "Excerpt from the Managed Defense Report with additional details about tasklist", "": ""}}, "3.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "Empire: 'qprocess *' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched qprocess.exe with an alert for Qprocess Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1057 - Process Discovery) and Tactic (Discovery). "}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified qprocess.exe as a reconnaissance command used.[FE5]"}], "Screenshots": {"FE-12.C.1-1.png": "Enrichment of qprocess.exe with Qprocess Execution alert (tagged with correct ATT&CK Technique, T1057 - Process Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating qprocess.exe was a reconnaissance command used (General Behavior)", "": ""}}}}, "T1007": {"TechniqueName": "System Service Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.D.1": {"Procedure": "Cobalt Strike: 'sc query' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that sc was one of the commands used to enumerate current running services. [FE5]"}], "Screenshots": {"FE-2.D.1-1.png": "Enrichment of sc.exe with SC Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-2.D.1-2.png": "Additional details from enrichment of sc.exe", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating sc was used to enumerate current running services (Specific Behavior)", "FE-2.D.1-3.png": "Excerpt from the Managed Defense Report with additional details about sc", "": ""}}, "2.D.2": {"Procedure": "Cobalt Strike: 'net start' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). "}, {" Specific Behavior, Delayed": "The Managed Defense Report indicated a Specific Behavior occurred because it identified that net was one of the commands used to enumerate current running services. [FE5]"}], "Screenshots": {"FE-2.D.2-1.png": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery) ", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net was used to enumerate current running services (Specific Behavior)", "FE-2.D.2-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "12.D.1": {"Procedure": "Empire: 'net start' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Start Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.D.1-1.png": "Enrichment of net.exe with Net Start Command Execution alert (tagged with correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}, "12.E.1.8": {"Procedure": "Empire: WinEnum module included enumeration of services", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). [FE7]"}], "Screenshots": {"FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-16.H.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "": ""}}, "16.J.1": {"Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery).[FE7] "}], "Screenshots": {"FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with the correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-16.J.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed reg.exe executing with command-line arguments to check if terminal services are enabled. The telemetry was tainted by the parent Reg Execution (Weak Signal) alert."}], "Screenshots": {"FE-17.A.1-1.png": "Telemetry showing reg.exe executing with command-line arguments (tainted by parent Reg Execution alert)", "": ""}}}}, "T1082": {"TechniqueName": "System Information Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.E.1": {"Procedure": "Cobalt Strike: 'systeminfo' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched systeminfo.exe with an alert for Systeminfo Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified systeminfo as a reconnaissance command used to obtain details from the system.[FE5]"}], "Screenshots": {"FE-2.E.1-1.png": "Enrichment of systeminfo.exe with Systeminfo Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery) ", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating systeminfo was a reconnaissance used to obtain system details (Specific Behavior)", "FE-2.E.1-2.png": "Excerpt from the Managed Defense Report with additional details about systeminfo", "": ""}}, "2.E.2": {"Procedure": "Cobalt Strike: 'net config workstation' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Config Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1082 - System Information Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified net config as a reconnaissance command performed. [FE5]"}], "Screenshots": {"FE-2.E.2-1.png": "Enrichment of net.exe with Net Config Command Execution alert (tagged with correct ATT&CK Technique, T1082 - System Information Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net config was a reconnaissance command (General Behavior)", "FE-2.E.2-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "12.E.1.6.1": {"Procedure": "Empire: WinEnum module included enumeration of system information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.6.2": {"Procedure": "Empire: WinEnum module included enumeration of Windows update information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1069": {"TechniqueName": "Permission Groups Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.F.1": {"Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]"}], "Screenshots": {"FE-2.F.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)", "FE-2.F.1-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "2.F.2": {"Procedure": "Cobalt Strike: 'net localgroup administrators /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)"}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated members of the local administrators group. [FE5]"}], "Screenshots": {"FE-2.F.2-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated members of the local administrators group (Specific Behavior)", "FE-2.F.2-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "2.F.3": {"Procedure": "Cobalt Strike: 'net group \"Domain Admins\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker enumerated the Shockwave domain's Domain Administrators group. [FE5]"}], "Screenshots": {"FE-2.F.3-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker enumerated the Domain Administrators group (Specific Behavior)", "FE-2.F.3-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "12.E.1.2": {"Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though telemetry showed loading of an assembly associated with accessing Active Directory security principals."}], "Screenshots": {"FE-12.E.1.2-1.png": "Telemetry showing loading of System.DirectoryServices.AccountManagement assembly (does not count as a detection)", "": ""}}, "12.F.1": {"Procedure": "Empire: 'net group \"Domain Admins\" /domain' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.F.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}, "12.F.2": {"Procedure": "Empire: 'net\u00a0localgroup\u00a0administrators' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1069 - Permission Groups Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.F.2-1.png": "Enrichment of net.exe with command-line arguments (tagged with correct ATT&CK Technique, T1069 - Permission Groups Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}}}, "T1087": {"TechniqueName": "Account Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.G.1": {"Procedure": "Cobalt Strike: 'net user /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]"}], "Screenshots": {"FE-2.G.1-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)", "FE-2.G.1-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "2.G.2": {"Procedure": "Cobalt Strike: 'net user George /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified net user as a reconnaissance command performed. [FE5]"}], "Screenshots": {"FE-2.G.2-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating net user was a reconnaissance command (General Behavior)", "FE-2.E.2-2.png": "Excerpt from the Managed Defense Report with additional details about net", "": ""}}, "7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in), which displays local account information."}], "Screenshots": {"FE-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.exe ", "": ""}}, "12.G.1": {"Procedure": "Empire: 'net user' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used to capture information about local users.[FE5]"}], "Screenshots": {"FE-12.G.1-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used to capture information about local users (General Behavior)", "": ""}}, "12.G.2": {"Procedure": "Empire: 'net user /domain' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net User Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1087 - Account Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used.[FE5]"}], "Screenshots": {"FE-12.G.2-1.png": "Enrichment of net.exe with Net User Command Execution alert (tagged with correct ATT&CK Technique, T1087 - Account Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}}}, "T1012": {"TechniqueName": "Query Registry", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.H.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "DetectionCategories": [{"Enrichment": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery)."}, {" Specific Behavior, Delayed ": " The Managed Defense Report indicated a Specific Behavior occurred because the attacker queried a registry key that contains system policy configurations. [FE5]"}], "Screenshots": {"FE-2.H.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)", "FE-2.B.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker queried a registry key that contains system policy configurations (Specific Behavior)", "FE-2.H.1-2.png": "Excerpt from the Managed Defense Report with additional details about reg", "": ""}}, "6.A.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "DetectionCategories": [{"Enrichment": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery). An alert was also generated for a File Write To Named Pipe (Weak Signal) for reg.exe. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified reg.exe as a reconnaissance command to enumerate a Registry key on the host Conficker to determine the configuration of its Windows Terminal Server service. [FE5]\u00a0"}], "Screenshots": {"FE-6.A.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)", "FE-6.A.1-2.png": "File Write To Named Pipe  alert for write to remote named pipe from reg.exe", "FE-6.A.1-3.png": "Additional details on named pipe alert", "FE-2.A.1-3.png": "Excerpt from Managed Defense Report of the reg command executing a remote registry query (Specific Behavior)", "FE-6.A.1-4.png": "Excerpt from the Managed Defense Report with additional details about reg query", "": ""}}, "12.E.1.7": {"Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "Empire:\u00a0'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Enrichment": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified reg.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-13.C.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with ATT&CK Technique T1018 - Query Registry, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating reg.exe was a reconnaissance command used (General Behavior)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Enrichment": "The capability enriched reg.exe with an alert for Reg Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1012 - Query Registry) and Tactic (Discovery)."}], "Screenshots": {"FE-17.A.1-1.png": "Enrichment of reg.exe with Reg Execution alert (tagged with correct ATT&CK Technique, T1012 - Query Registry, and Tactic, Discovery)", "": ""}}}}, "T1134": {"TechniqueName": "Access Token Manipulation", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "DetectionCategories": [{"Telemetry, Configuration Change": "Telemetry showed a svchost.exe seclogon event for a token logon ID later used by a process whose group membership indicated high integrity. [FE6]"}], "Screenshots": {"FE-3.A.1-3.png": "Telemetry showing svchost.exe seclogon event for token login ID 0xfcf5fd", "FE-3.A.1-4.png": "Telemetry showing group membership of token logon ID 0xfcf5fd, which includes S-1-16-12288 (High Mandatory Level)", "": ""}}, "5.B.1": {"Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "DetectionCategories": [{"Telemetry": "Telemetry showed a process (net.exe) executed during Step 4 as user Debbie and a subsequent process (reg.exe) executed during Step 6 as user George, indicating a change in user context from a stolen token. "}], "Screenshots": {"FE-4.A.1-1.png": "Telemetry showing the user Debbie executing net.exe with command-line arguments during Step 4", "FE-5.B.1-1.png": "Telemetry showing the user George executing reg.exe with command-line arguments during Step 6", "": ""}}}}, "T1088": {"TechniqueName": "Bypass User Account Control", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "DetectionCategories": [{"Telemetry, Configuration Change": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Debbie. [FE6]"}], "Screenshots": {"FE-3.A.1-3.png": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0xfcf5fd", "FE-3.A.1-4.png": "Telemetry showing group membership of token logon ID 0xfcf5fd, associated with user Debbie, which includes S-1-16-12288 (High Mandatory Level)", "": ""}}, "14.A.1": {"Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "DetectionCategories": [{"Telemetry, Configuration Change": "Telemetry showed execution of powershell.exe as a high integrity process as SYSTEM with a token login ID previously associated with user Bob, which indicates UAC bypassing. [FE6]"}], "Screenshots": {"FE-14.A.1-7.png": "Telemetry showing execution of powershell.exe running as SYSTEM with token login ID 0x10530b3 ", "FE-14.A.1-8.png": "Telemetry showing group membership of token logon ID 0x10530b3 associated with user Bob, which includes S-1-16-12288 (High Mandatory Level)", "": ""}}}}, "T1055": {"TechniqueName": "Process Injection", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.C.1": {"Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "DetectionCategories": [{"Specific Behavior, Delayed": "The Managed Defense Report indicated a Specific Behavior occurred because it identified a process injection from PowerShell.exe to cmd.exe. [FE5][FE11] "}], "Screenshots": {"FE-3.C.1-1.png": "Excerpt from the Managed Defense Report identifying a process injection from PowerShell.exe to cmd.exe (Specific Behavior)", "FE-3.C.1-2.png": "Continued excerpt from the Managed Defense Report showing the artifact evidence of a process injection from PowerShell.exe to cmd.exe", "": ""}}, "5.A.1": {"Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "8.D.1": {"Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1018": {"TechniqueName": "Remote System Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.A.1": {"Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery)."}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]"}], "Screenshots": {"FE-4.A.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)", "FE-4.A.1-2.png": "Excerpt from the Managed Defense Report with additional details about net group", "": ""}}, "4.A.2": {"Procedure": "Cobalt Strike: 'net group \"Domain Computers\" /domain' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1069 - Permission Groups Discovery) and the correct Tactic (Discovery)."}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it indicated net group was one of the reconnaissance commands performed. [FE5]"}], "Screenshots": {"FE-4.A.2-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with related ATT&CK Technique, T1069 - Permission Groups Discovery, and correct Tactic, Discovery)", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating net group was a reconnaissance command (General Behavior)", "FE-4.A.2-2.png": "Excerpt from the Managed Defense Report with additional details about net group", "": ""}}, "13.A.1": {"Procedure": "Empire: 'net group \"Domain Computers\" /domain' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Group Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1018 - Remote System Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-13.A.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1018 -Remote System Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}}}, "T1049": {"TechniqueName": "System Network Connections Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.C.1": {"Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that netstat was a reconnaissance command used to enumerate active and listening network ports. [FE5]"}], "Screenshots": {"FE-4.C.1-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with the correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)", "FE-2.A.1-3.png": "Excerpt from the Managed Defense Report indicating netstat was used to enumerate active and listening network ports (Specific Behavior)", "FE-4.C.1-2.png": "Excerpt from the Managed Defense Report with additional details about netstat", "": ""}}, "12.E.1.12": {"Procedure": "Empire: WinEnum module included enumeration of established network connections", "DetectionCategories": [{"Enrichment": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connection Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-12.E.1.12-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)", "": ""}}, "13.B.1": {"Procedure": "Empire: 'net use' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified net.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-13.B.1-1.png": "Enrichment of net.exe with Net Group Command Execution alert (tagged with correct ATT&CK Technique, T1049 -System Network Connections Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating net.exe was a reconnaissance command used (General Behavior)", "": ""}}, "13.B.2": {"Procedure": "Empire: 'netstat -ano' via PowerShell", "DetectionCategories": [{"Enrichment": "The capability enriched netstat.exe with an alert for Netstat Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1049 - System Network Connections Discovery) and Tactic (Discovery)."}, {" General Behavior, Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified netstat.exe as a reconnaissance command used. [FE5]"}], "Screenshots": {"FE-13.B.2-1.png": "Enrichment of netstat.exe with Netstat Execution alert (tagged with correct ATT&CK Technique, T1049 - System Network Connections Discovery, and Tactic, Discovery)", "FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating netstat.exe was a reconnaissance command used (General Behavior)", "": ""}}}}, "T1003": {"TechniqueName": "Credential Dumping", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"5.A.1": {"Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "5.A.2": {"Procedure": "hashdump", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1026": {"TechniqueName": "Multiband Communication", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "DetectionCategories": [{"Telemetry ": "Telemetry showed a combination of both DNS requests as well as HTTP requests, which could indicate multiband communication. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified C2 communication over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2. [FE5]"}], "Screenshots": {"FE-6.B.1-2.png": "Telemetry showing DNS requests (field name dnsLookupEvents/Generated) and HTTP requests (field name urlMonitorEvents/Generated)", "FE-6.B.1-4.png": "Excerpt from the Managed Defense Report identifying C2 traffic communicating over TCP port 80 to www.freegoogleadsenseinfo.com (C2 domain) in addition to the ongoing DNS C2 (Specific Behavior)", "": ""}}}}, "T1076": {"TechniqueName": "Remote Desktop Protocol", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"6.C.1": {"Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "DetectionCategories": [{"Enrichment": "The capability enriched the RDP connection from rundll32.exe with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement)."}], "Screenshots": {"FE-6.C.1-1.png": "Enrichment of RDP connection from rundll32.exe with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)", "": ""}}, "10.B.1": {"Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "DetectionCategories": [{"Enrichment": "The capability enriched a TCP port 3389 connection to 10.0.0.5 (Conficker) with the alert RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement). "}, {" Telemetry": " Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the user account Jesse logged on to Conficker via Remote Desktop Protocol. [FE5]"}], "Screenshots": {"FE-10.B.1-1.png": "Enrichment of port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique, T1076 - Remote Desktop Protocol, and Tactic, Lateral Movement)", "FE-10.B.1-4.png": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker", "FE-10.B.1-3.png": "Excerpt from Managed Defense Report indicating account Jesse was used to logon via Remote Desktop Protocol (Specific Behavior)", "": ""}}, "20.A.1": {"Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "DetectionCategories": [{"Enrichment": "The capability enriched a TCP port 3389 connection with an alert for RDP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1076 - Remote Desktop Protocol) and Tactic (Lateral Movement)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the use of the Remote Desktop Protocol to connect to Creeper.[FE5]"}], "Screenshots": {"FE-20.A.1-1.png": "Enrichment of TCP port 3389 connection with RDP Network Connection alert (tagged with correct ATT&CK Technique T10176 - Remote Desktop Protocol, and Tactic, Lateral Movement)", "FE-20.A.1-2.png": "Excerpt from the Managed Defense Report indicating Remote Desktop Protocol was used to connect to Creeper (Specific Behavior)", "": ""}}}}, "T1136": {"TechniqueName": "Create Account", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry from Conficker showed the creation of the new user Jesse."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the creation of a local user account for Jesse on Conficker. [FE5]"}], "Screenshots": {"FE-7.A.1-1.png": "Telemetry showing creation of user Jesse ", "FE-7.A.1-4.png": "Excerpt from the Managed Defense Report showing the creation of the user Jesse (Specific Behavior)", "": ""}}}}, "T1061": {"TechniqueName": "Graphical User Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in)."}], "Screenshots": {"FE-7.A.1-3.png": "Telemetry showing mmc.exe spawning lusrmgr.exe ", "": ""}}}}, "T1105": {"TechniqueName": "Remote File Copy", "TacticGroup": "Command and Control, Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"7.B.1": {"Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "DetectionCategories": [{"Enrichment": "The capability enriched updater.dll being written by cmd.exe with an alert for CMD File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105\u00a0- Remote File Copy) and a related ATT&CK Technique (T1059 - Command-Line Interface) and Tactic (Execution).\u00a0"}, {" Telemetry, Tainted": " Telemetry showed the file write for updater.dll into the system32 folder. The telemetry was tainted by the parent AV signature alert for updater.dll."}], "Screenshots": {"FE-7.B.1-1.png": "Enrichment of updater.dll file write by cmd.exe with alert for CMD File Write (tagged with correct ATT&CK Technique, T1105 \u00a0- Remote File Copy, and related ATT&CK Technique, T1059 - Command-Line Interface, and Tactic, Execution)", "FE-7.B.1-2.png": "Telemetry showing updater.dll file write (tainted by parent AV signature alert)", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "DetectionCategories": [{"Enrichment": "The capability enriched a HTTP GET request for wdbypass with an alert for PowerShell URL Request (Weak Signal). The alert also was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Command and Control)."}], "Screenshots": {"FE-14.A.1-4.png": "Enrichment of HTTP GET request for wdbypass with PowerShell URL Request alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy, and Tactic, Command and Control)", "": ""}}, "16.E.1": {"Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Enrichment": "The capability enriched powershell.exe writing autoupdate.vbs with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement)."}], "Screenshots": {"FE-16.E.1-1.png": "Enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy) and Tactics, Command and Control and Lateral Movement)", "FE-16.E.1-2.png": "Additional details on enrichment of powershell.exe writing autoupdate.vbs with PowerShell File Write alert", "": ""}}, "16.G.1": {"Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment ": "The capability enriched powershell.exe writing update.vbs with an alert for File Write to Network Share (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactic (Lateral Movement). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the autoupdate.vbs script being written to Creeper. [FE5]"}], "Screenshots": {"FE-16.G.1-1.png": "Enrichment of powershell.exe writing update.vbs with File Write to Network Share alert", "FE-16.G.1-2.png": "Excerpt from the Managed Defense Report of the write of the autoupdate.vbs script (Specific Behavior)", "": ""}}, "19.A.1": {"Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Enrichment": "The capability enriched powershell.exe writing recycler.exe with an alert for PowerShell File Write (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1105 - Remote File Copy) and Tactics (Command and Control, Lateral Movement)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker placed recycler.exe on the system.[FE5]"}], "Screenshots": {"FE-19.A.1-1.png": "Enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert (tagged with correct ATT&CK Technique, T1105 - Remote File Copy and Tactics, Command and Control, Lateral Movement)", "FE-19.A.1-2.png": "Continued enrichment of powershell.exe writing recycler.exe with PowerShell File Write alert", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker placed recycler.exe on the system (Specific Behavior)", "": ""}}}}, "T1053": {"TechniqueName": "Scheduled Task", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.C.1": {"Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "DetectionCategories": [{"Enrichment": "The capability enriched schtasks.exe with an alert for Scheduled Task Activity (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1053 - Scheduled Task) and Tactics (Execution, Persistence, and Privilege Escalation)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that updater.dll persisted through the creation of a scheduled task. [FE5]"}], "Screenshots": {"FE-7.C.1-1.png": "Enrichment of schtasks.exe with Scheduled Task Activity alert (tagged with correct ATT&CK Technique, T1053 - Scheduled Task, and Tactic, Execution, Persistence, Privilege Escalation)", "FE-7.C.1-3.png": "Excerpt from the Managed Defense Report indicating updater.dll persisted through a scheduled task (Specific Behavior)", "FE-7.C.1-2.png": "Excerpt from the Managed Defense Report with additional details about schtask", "": ""}}, "10.A.2": {"Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "DetectionCategories": [{"Telemetry,Tainted ": "Telemetry showed svchost.exe executing rundll32.exe, which executed updater.dll. The telemetry was tainted by the parent Rundll32 Execution alert, which was tagged with a related ATT&CK Technique (T1085 - Rundll32) and Tactic (Defense Evasion, Execution), but did not include information on the use of a Scheduled Task specifically. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the Resume Viewer Update Checker scheduled task executing updater.dll with rundll32.exe. [FE5]"}], "Screenshots": {"FE-10.A.2-1.png": "Telemetry showing rundll32.exe executing updater.dll", "FE-10.A.2-2.png": "Parent Rundll32 Execution alert that tainted updater.dll telemetry (tagged with related ATT&CK Technique, T1085 - Rundll32, and Tactic, Defense Evasion, Execution; does not include specific Scheduled Task information)", "FE-10.A.2-3.png": "Excerpt from Managed Defense Report indicating the Resume Viewer Update Checker scheduled task executed updater.dll with rundll32.exe (Specific Behavior)", "": ""}}}}, "T1083": {"TechniqueName": "File and Directory Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.A.1": {"Procedure": "Cobalt Strike: 'dir /s /b \"\\\\conficker\\wormshare\"' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched cmd.exe executing dir with an alert for Dir Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery)."}], "Screenshots": {"FE-8.A.1-1.png": "Enrichment of cmd.exe executing dir with Dir Command alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and, Tactic, Discovery)", "": ""}}, "8.A.2": {"Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "DetectionCategories": [{"Enrichment": "The capability enriched cmd.exe executing tree with an alert for Tree Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1083 - File and Directory Discovery) and Tactic (Discovery). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker performed a directory listing of the contents of Debbie's user profile directory. [FE5]"}], "Screenshots": {"FE-8.A.1-2.png": "Enrichment of cmd.exe executing tree with Tree Command Execution alert (tagged with correct ATT&CK Technique, T1083 - File and Directory Discovery and Tactic, Discovery)", "FE-7.C.1-3.png": "Excerpt from the Managed Defense Report identifying a directory listing of Debbie's profile directory (Specific Behavior)", "FE-8.A.1-4.png": "Excerpt from Managed Defense Report showing additional details about tree", "": ""}}, "9.A.1": {"Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.1": {"Procedure": "Empire: WinEnum module included enumeration of recently opened files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.2": {"Procedure": "Empire: WinEnum module included enumeration of interesting files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "DetectionCategories": [{"None": "No detection capability identified for this procedure."}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1010": {"TechniqueName": "Application Window Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1056": {"TechniqueName": "Input Capture", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though the capability detected PowerShell activity during the time of the keylogging. "}], "Screenshots": {"FE-15.A.1-1.png": "PowerShell activity during the time of the keylogging (does not count as detection)", "": ""}}}}, "T1113": {"TechniqueName": "Screen Capture", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"8.D.1": {"Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1039": {"TechniqueName": "Data from Network Shared Drive", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1041": {"TechniqueName": "Exfiltration Over Command and Control Channel", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though DNS requests for freegoogleadsenseinfo.com (C2 domain) were observed."}], "Screenshots": {"FE-9.B.1-1.png": "DNS requests to freegoogleadsenseinfo.com (C2 domain) (does not count as a detection)", "": ""}}}}, "T1078": {"TechniqueName": "Valid Accounts", "TacticGroup": "Defense Evasion, Persistence, Privilege Escalation, Initial Access", "PrimaryEnabling": "Primary", "Steps": {"10.B.1": {"Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "DetectionCategories": [{"Telemetry": "Telemetry showed a Logon Type 10 (interactive) event for the account Jesse logging on to Conficker."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the account Jesse was used to log in to Conficker as part of Lateral Movement.[FE5]"}], "Screenshots": {"FE-10.B.1-2.png": "Telemetry showing Logon Type 10 (interactive) event for Jesse logging on to Conficker", "FE-10.B.1-3.png": "Excerpt from Managed Defense Report indicating account Jesse was used to logon to Conficker as part of Lateral Movement (Specific Behavior)", "": ""}}, "16.B.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "DetectionCategories": [{"Enrichment": "The capability enriched a logon attempt via net.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for Kmitnick was redacted within the capability. [FE10] "}, {"Telemetry": " Telemetry showed the successful logon for the user Kmitnick.\u00a0"}], "Screenshots": {"FE-16.B.1-1.png": "Enrichment of net.exe logon attempt by Kmitnick with Net Use Command Execution alert", "FE-16.B.1-2.png": "Telemetry showing successful logon of user Kmitnick", "": ""}}, "16.D.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "DetectionCategories": [{"Enrichment": "The capability enriched a logon attempt via net1.exe using valid credentials for user Kmitnick with an alert for Net Use Command Execution (Weak Signal). The password for the user Kmitnick was redacted by the capability.[FE10] "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]"}], "Screenshots": {"FE-16.D.1-1.png": "Enrichment of net1.exe logon attempt by Kmitnick with Net Use Command Execution alert", "FE-16.D.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)", "": ""}}}}, "T1086": {"TechniqueName": "PowerShell", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"11.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "15.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.I.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.J.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.L.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1032": {"TechniqueName": "Standard Cryptographic Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"11.B.1": {"Procedure": "Empire: Encrypted C2 channel established using HTTPS", "DetectionCategories": [{"General Behavior,Delayed": "The Managed Defense Report indicated a General Behavior occurred because it identified that the Empire backdoor was configured to communicate with freegoogleadsenseinfo.com (C2 domain) over HTTPS.[FE5]"}], "Screenshots": {"FE-11.B.1-4.png": "Excerpt from the Managed Defense Report indicating Empire was configured to communicate over HTTPS (General Behavior)", "": ""}}}}, "T1063": {"TechniqueName": "Security Software Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.10.1": {"Procedure": "Empire: WinEnum module included enumeration of AV solutions", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.10.2": {"Procedure": "Empire: WinEnum module included enumeration of firewall rules", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1201": {"TechniqueName": "Password Policy Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.3": {"Procedure": "Empire: WinEnum module included enumeration of password policy information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1115": {"TechniqueName": "Clipboard Data", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.5": {"Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "DetectionCategories": [{"Indicator of Compromise, Delayed": "The Managed Defense Report indicated an Indicator of Compromise detection occurred because it identified that the attacker executed the Windows Clipboard capability in Empire. The capability separately showed a PowerShell Execution (Weak Signal) alert containing the encoded PowerShell command. This command could be decoded, but this was not counted as a separate detection because it was external to the capability. [FE5]"}], "Screenshots": {"FE-12.A.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker executed the Windows Clipboard capability of Empire (Indicator of Compromise)", "FE-12.E.1.5-1.png": "PowerShell Execution alert containing encoded PowerShell command (does not count as a detection)", "FE-12.E.1.5-2.png": "Decoding (outside the capability) of encoded PowerShell command to show Windows.Clipboard details (does not count as a detection)", "": ""}}}}, "T1135": {"TechniqueName": "Network Share Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.9.1": {"Procedure": "Empire: WinEnum module included enumeration of available shares", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.9.2": {"Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1081": {"TechniqueName": "Credentials in Files", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"15.B.1": {"Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1110": {"TechniqueName": "Brute Force", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00a0Kmitnick, Bob, and Frieda", "DetectionCategories": [{"Enrichment": "The capability enriched repeated logon attempts via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Share) and Tactic (Lateral Movement). \u00a0The four events were included under the same alert and each of the passwords were redacted by the capability. [FE10]"}, {"Telemetry, Configuration Change": " Telemetry showed the logon failure from Kmitnick by searching for Windows Security Log Event ID 4625. [FE3] "}, {" General Behavior, Delayed": " The Managed Defense Report indicated a General Behavior occurred because it identified that the attacker attempted to access systems using four accounts.[FE5]"}], "Screenshots": {"FE-16.A.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Frieda; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-2.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Bob; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-3.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-4.png": "Enrichment of net.exe with Net Use Command Execution alert (showing logon attempts for the user Kmitnick; tagged with related ATT&CK Technique, T1077 - Windows Admin Share, and Tactic, Lateral Movement)", "FE-16.A.1-5.png": "Telemetry showing failed logon attempt for Kmitnick", "FE-16.A.1-6.png": "Excerpt from the Managed Defense Report indicating the attacker attempted to access systems using four accounts (General Behavior)", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)."}, {" Telemetry": " Telemetry showed the successful logon for the user Kmitnick. "}], "Screenshots": {"FE-16.B.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with related ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement)", "FE-16.B.1-2.png": "Telemetry showing successful logon of user Kmitnick", "": ""}}}}, "T1077": {"TechniqueName": "Windows Admin Shares", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "DetectionCategories": [{"Enrichment": "The capability enriched net.exe with an alert for Net Use Command Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement). The four events were included under the same alert."}], "Screenshots": {"FE-16.A.1-1.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Frieda", "FE-16.A.1-2.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Bob", "FE-16.A.1-3.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick", "FE-16.A.1-4.png": "Enrichment of net.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique T1077 - Windows Admin Shares, and Tactic, Lateral Movement) for user Kmitnick", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00a0", "DetectionCategories": [{"Enrichment": "The capability enriched a logon attempt via net.exe with an alert for Net Use Command Execution (Weak Signal). The alert details showed net.exe with command-line arguments targeting ADMIN$ using valid credentials for user Kmitnick. The alert was also tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker accessed Conficker by mounting the ADMIN$ share. [FE5]"}], "Screenshots": {"FE-16.B.1-1.png": "Enrichment of net.exe logon attempt to ADMIN$ with Net Use Command Execution alert (tagged with the correct ATT&CK Technique, 1077 - Windows Admin Shares, and Tactic, Lateral Movement)", "FE-16.B.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker accessed Conficker by mounting the ADMIN$ share (Specific Behavior)", "": ""}}, "16.D.1": {"Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "DetectionCategories": [{"Enrichment": "The capability enriched net1.exe with an alert for Net Use Command Execution (Weak Signal). The alert also was tagged with the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker mounted the C$ drive on creeper with the kmitnick account. [FE5]"}], "Screenshots": {"FE-16.D.1-1.png": "Enrichment of net1.exe with Net Use Command Execution alert (tagged with correct ATT&CK Technique, T1077 - Windows Admin Shares, and Tactic, Lateral Movement)", "FE-16.D.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker mounting the C$ on creeper with the kmitnick account (Specific Behavior)", "": ""}}}}, "T1126": {"TechniqueName": "Network Share Connection Removal", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.C.1": {"Procedure": "Empire: 'net use /delete' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry showed net.exe executing with command-line arguments. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker unmounted the share from CodeRed. [FE5]"}], "Screenshots": {"FE-16.C.1-1.png": "Telemetry showed net.exe executing with command-line arguments. ", "FE-16.B.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker unmounted the share from CodeRed (Specific Behavior)", "": ""}}}}, "T1036": {"TechniqueName": "Masquerading", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment": "The capability enriched the sc.exe command with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and the correct Tactic (Discovery).  [FE7] "}], "Screenshots": {"FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with related correct ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-16.I.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "": ""}}, "19.A.1": {"Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Telemetry, Tainted ": "Telemetry showed the MD5 hash value of recycler.exe when it was written to disk, which an analyst could use to determine recycler.exe was actually WinRAR. The telemetry was tainted by the parent PowerShell File Write alert. "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified the attacker placing the WinRAR utility on the system as recycler.exe. [FE5]"}], "Screenshots": {"FE-19.A.1-2.png": "Telemetry showing MD5 hash of recycler.exe", "FE-19.A.1-1.png": "Parent alert for PowerShell File Write showing tainting of recycler.exe telemetry", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report of the attacker placing the WinRAR utility on the system as recycler.exe (Specific Behavior)", "": ""}}, "19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data."}, {" Enrichment": " The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with related ATT&CK Techniques (T1022 - Data Encrypted and T1002 - Data Compressed). "}, {" Enrichment ": " The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration)."}, {" General Behavior ": " A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin.  "}, {" Enrichment ": " The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration)."}, {" Specific Behavior, Delayed": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive.[FE5]"}], "Screenshots": {"FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with related ATT&CK Techniques, T1022 - Data Encrypted and T1002 - Data Compressed)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}}}}, "T1050": {"TechniqueName": "New Service", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1050 - New Service) and Tactic (Persistence)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command creating a new service called adobeupdater on Creeper from CodeRed. [FE5][FE7] "}], "Screenshots": {"FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (Weak Signal) (tagged with correct ATT&CK Technique, T1050 - New Service, and Tactic, Discovery)", "FE-16.I.1-1.png": "Additional details on enrichment of sc.exe with SC Execution alert", "FE-16.I.1-3.png": "Excerpt from the Managed Defense Report indicating sc.exe was used to create a new service (Specific Behavior)", "": ""}}}}, "T1035": {"TechniqueName": "Service Execution", "TacticGroup": "Exectuion", "PrimaryEnabling": "Primary", "Steps": {"16.L.1": {"Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Enrichment": "The capability enriched sc.exe with an alert for SC Execution (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1007 - System Service Discovery) and Tactic (Discovery). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it observed the sc.exe command starting the adobeupdater service on Creeper. [FE5][FE7] "}], "Screenshots": {"FE-16.L.1-1.png": "Enrichment of sc.exe with an alert for SC Execution (tagged with related ATT&CK Technique, T1007 - System Service Discovery, and Tactic, Discovery)", "FE-16.I.1-3.png": "Excerpt from the Managed Defense Report showing sc.exe starting the adobeupdater service (Specific Behavior)", "": ""}}}}, "T1222": {"TechniqueName": "File Permissions Modification", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"17.B.1": {"Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "DetectionCategories": [{"Enrichment": "The capability enriched takeown.exe with an alert for Takeown Execution. The alert described how takeown can be used to change file ownership."}], "Screenshots": {"FE-17.B.1-1.png": "Enrichment of takeown.exe with Takeown Execution alert", "": ""}}, "17.B.2": {"Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "DetectionCategories": [{"Enrichment": "The capability enriched icacls.exe with an alert for Icacls Execution. The alert described how icacls can be used to display or change Windows file ACLs."}], "Screenshots": {"FE-17.B.2-1.png": "Enrichment of icacls.exe with Icacls Execution alert", "": ""}}}}, "T1015": {"TechniqueName": "Accessibility Features", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"17.C.1": {"Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "DetectionCategories": [{"Specific Behavior": "A Specific Behavior alert was generated for Suspicious Accessibility Features Replacement (BACKDOOR) based on magnifer.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence)."}, {" Specific Behavior": " A Specific Behavior alert was also generated for Accessibility Features File Write (Weak Signal) based on magnifier.exe being overwritten. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactic (Persistence). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified magnifer.exe being overwritten with cmd.exe. [FE5]"}], "Screenshots": {"FE-17.C.1-1.png": "Specific Behavior alert on overwrite of magnify.exe for Suspicious Accessibility Features Replacement (BACKDOOR) (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)", "FE-17.C.1-2.png": "Specific Behavior alert on overwrite of the magnify.exe for Accessibility Feature File Write (tagged with correct ATT&CK Technique, T1015 - Accessibility Features, and Tactic, Persistence)", "FE-17.C.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker overwrote magnifier.exe (Specific Behavior)", "": ""}}, "20.A.1": {"Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for RENAMED CMD.EXE, with a description explaining how attackers will sometimes rename cmd.exe to other filenames to try to bypass detections. "}, {" Specific Behavior": " A Specific Behavior alert was generated for Accessibility Features Child Process due to whoami.exe spawning from magnify.exe. The alert was also tagged with the correct ATT&CK Technique (T1015 - Accessibility Features) and Tactics (Persistence, Privilege Escalation)."}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it identified that the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell. [FE5]"}], "Screenshots": {"FE-20.A.1-3.png": "General Behavior alert for RENAMED CMD.EXE", "FE-20.A.1-4.png": "Continued details for General Behavior alert for RENAMED CMD.EXE", "FE-20.A.1-5.png": "Specific Behavior alert for Accessibility Features Child Process due to magnify.exe spawning whoami.exe (tagged with the correct ATT&CK Technique, T1015 - Accessibility Features, and Tactics, Persistence, Privilege Escalation)", "FE-20.A.1-2.png": "Excerpt from the Managed Defense Report indicating the attacker replaced the magnifier.exe accessibility feature to launch a privileged command shell (Specific Behavior)", "": ""}}}}, "T1074": {"TechniqueName": "Data Staged", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"18.B.1": {"Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry, Tainted": "Telemetry showed the creation of the .vsdx file in the Recycle Bin. The telemetry was tainted by the parent PowerShell File Write alert."}, {" Specific Behavior": " A Specific Behavior alert was generated on the file write of the .vsdx named File Write To Root Of Recycle Bin (Weak Signal). The alert details explained how all legitimate files should be written to a subfolder of the recycle bin, and not to the root."}], "Screenshots": {"FE-18.B.1-1.png": "Telemetry showing powershell.exe file write of .vsdx to the Recycle Bin with PowerShell File Write alert", "FE-18.B.1-2.png": "Additional telemetry showing file write of .vsdx with PowerShell File Write alert", "FE-18.B.1-3.png": "Specific Behavior alert for File Write to Root of Recycle Bin", "": ""}}}}, "T1002": {"TechniqueName": "Data Compressed", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data."}, {" Enrichment": "The capability enriched the command line output containing -hp with an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed). "}, {" Enrichment": " The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration). "}, {" General Behavior": " A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin. "}, {" Enrichment": " The capability enriched the file write of RAR with a second alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with the correct ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration). "}, {" Specific Behavior, Delayed": "The Managed Defense Report indicated a Specific Behavior occurred because it indicated the attacker executed recycler.exe to create an encrypted RAR file old.rar.[FE5]"}], "Screenshots": {"FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with correct ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}}}}, "T1022": {"TechniqueName": "Data Encrypted", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "DetectionCategories": [{"General Behavior": "A General Behavior alert was generated for Execution from Suspicious Directory (Weak Signal). The alert detected processes running from uncommon locations, and included recycler.exe executing with full command-line arguments, including the use of the -hp flag to encrypt and compress data."}, {" Enrichment": " The capability enriched an alert for Possible Encrypted RAR Archive Command (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1022 - Data Encrypted). "}, {" Enrichment ": " The capability enriched the file write of RAR with an alert for Rar Archive Created (Weak Signal) based on the header values of the file. The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration). "}, {" General Behavior ": " A General Behavior alert called File Write To Root Of Recycle Bin (Weak Signal) was generated for old.rar being written to the root of the Recycle Bin. The alerted noted that all legitimate files should be written to a subfolder of the Recycle Bin. "}, {" Enrichment ": " The capability enriched recycler.exe writing old.rar to the root of the Recycle Bin with an alert for Rar Archive Created (Weak Signal). The alert was also tagged with a related ATT&CK Technique (T1002 - Data Compressed) and Tactic (Exfiltration)."}, {" Specific Behavior, Delayed": "The Managed Defense Report indicated a Specific Behavior occurred because it observed recycler.exe creating an encrypted RAR archive. [FE5]"}], "Screenshots": {"FE-19.B.1-1.png": "General Behavior alert for Execution from Suspicious Directory", "FE-19.B.1-2.png": "Enrichment of -hp command line with Possible Encrypted RAR Archive Command alert (tagged with correct ATT&CK Technique, T1022 - Data Encrypted)", "FE-19.B.1-3.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.B.1-4.png": "General Behavior alert for File Write To Root Of Recycle Bin", "FE-19.B.1-5.png": "Enrichment of RAR file write with RAR Archive Created alert (tagged with a related ATT&CK Technique, T1002 - Data Compressed, and Tactic, Exfiltration)", "FE-19.A.1-3.png": "Excerpt from the Managed Defense Report indicating the attacker executed recycler.exe to create an encrypted RAR file (Specific Behavior)", "": ""}}}}, "T1048": {"TechniqueName": "Exfiltration Over Alternative Protocol", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.C.1": {"Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "DetectionCategories": [{" Enrichment ": "The capability enriched ftp.exe execution with an alert for FTP Utility Execution (Weak Signal). The alert was also tagged with the correct ATT&CK Software (T0095 - FTP)."}, {" Enrichment ": " The capability enriched ftp.exe with the -s argument with a separate alert for FTP Utility Execution (Weak Signal)."}, {" Enrichment ": " The capability enriched a TCP port 21 connection to 192.168.0.4 (C2 server) with an alert for FTP Network Connection (Weak Signal). The alert was also tagged with the correct ATT&CK Technique (T1048 - Exfiltration Over Alternative Protocol) and Tactic (Exfiltration). "}, {" Specific Behavior, Delayed": " The Managed Defense Report indicated a Specific Behavior occurred because it observed the ftp commands being written to ftp.txt and the subsequent execution of ftp.exe with the file. The old.rar file was seen uploaded to 192.168.0.4 (C2 server). [FE5]"}], "Screenshots": {"FE-19.C.1-3.png": "Enrichment of ftp.exe executing the ftp.txt file with FTP Utility Execution alert (tagged with the correct ATT&CK Software, S0095 - FTP)", "FE-19.C.1-4.png": "Enrichment of ftp.exe executing ftp.exe based on the use of the -s argument with FTP Utility Execution alert", "FE-19.C.1-5.png": "Enrichment of TCP port 21 connection to 192.168.0.4 (C2 server) (tagged with correct ATT&CK Technique, T1048 - Exfiltration Over Alternative Protocol and, Tactic, Exfiltration)", "FE-19.C.1-6.png": "Excerpt from the Managed Defense Report showing the writing of FTP command to ftp.txt and the subsequent execution of the ftp.txt file (Specific Behavior)", "": ""}}}}, "T1107": {"TechniqueName": "File Deletion", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"19.D.1": {"Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "19.D.2": {"Procedure": "Empire: 'del recycler.exe'", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}}