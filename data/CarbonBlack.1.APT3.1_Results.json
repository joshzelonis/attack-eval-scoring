{"T1204": {"TechniqueName": "User Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Legitimate user Debbie clicked and executed malicious self-extracting archive (Resume Viewer.exe) on 10.0.1.6 (Nimda)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed Resume Viewer.exe running along with its children."}, {" General Behavior": "A General Behavior alert was generated indicating that the user Debbie executed Resume Viewer.exe. This alert had a severity score of 51/100 and was based upon \\\"Newly Executed Applications\\\"."}], "Screenshots": {"CB-1.A.1-2.png": "Telemetry from process tree showing Resume Viewer.exe execution sequence", "CB-1.A.1-1.png": "General Behavior alert showing execution of Resume Viewer.exe as a Newly Executed Application", "": ""}}}}, "T1064": {"TechniqueName": "Scripting", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed self-extracting archive (Resume Viewer.exe) launched an embedded batch file (pdfhelper.cmd)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing the pdfhelper.cmd script."}, {" Enrichment": "The capability enriched the cmd.exe execution with the correct ATT&CK Technique (T1064 - Scripting)."}], "Screenshots": {"CB-1.A.1-3.png": "Telemetry from process tree showing cmd.exe running the pdfhelper.cmd script", "CB-1.A.1-1.png": "Enrichment of cmd.exe executing pdfhelper.cmd with correct ATT&CK Technique (T1064 - Scripting)", "": ""}}, "11.A.1": {"Procedure": "Legitimate user Bob clicked and executed malicious VBScript (autoupdate.vbs) on 10.0.1.5 (CodeRed)", "DetectionCategories": [{"Enrichment ": "The capability enriched wscript.exe and powershell.exe with the correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)."}, {" Telemetry ": "Telemetry of a process tree showed powershell.exe execution, including full command-line arguments."}, {" Specific Behavior": " A Specific Behavior Alert was generated indicating that powershell.exe was a suspicious child process of wscript.exe."}, {" Specific Behavior": " A Specific Behavior alert was generated indicating that powershell.exe was executed with encoded command-line arguments.\u00a0"}], "Screenshots": {"CB-11.A.1-1.png": "Enrichment of wscript.exe and powershell.exe with correct ATT&CK Techniques (T1063 - Scripting, T1086 - Powershell)", "CB-11.A.1-2.png": "Telemetry showing process tree of script execution", "CB-11.A.1-3.png": "Specific Behavior alerts for Powershell scripting", "": ""}}, "12.E.1": {"Procedure": "Empire: Built-in WinEnum module executed to programmatically execute a series of enumeration techniques", "DetectionCategories": [{"Telemetry": "Telemetry showed process execution of powershell.exe. The powershell.exe process loaded several non-default dynamically loaded libraries that may indicate the functionality may be used by the PowerShell script."}], "Screenshots": {"CB-12.E.1-1.png": "Telemetry showing powershell.exe execution", "CB-12.E.1-2.png": "Telemetry showing dynamically loaded libraries (modloads) that may indicate PowerShell functionality", "": ""}}}}, "T1085": {"TechniqueName": "Rundll32", "TacticGroup": "Defense Evasion, Execution", "PrimaryEnabling": "Primary", "Steps": {"1.A.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) launched a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed the Resume Viewer.exe execution sequence and rundll32.exe executing."}, {" Enrichment": " The capability enriched the rundll32.exe execution with the correct ATT&CK Technique (T1085, which corresponds to the Rundll32 Technique)."}], "Screenshots": {"CB-1.A.1-2.png": "Telemetry from process tree showing Resume Viewer.exe execution sequence with rundll32.exe", "CB-1.A.1-1.png": "Enrichment of rundll32.exe execution with correct ATT&CK Technique (T1085, corresponding to Rundll32)", "": ""}}}}, "T1060": {"TechniqueName": "Registry Run Keys / Startup Folder", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"1.B.1": {"Procedure": "Previously executed batch file (pdfhelper.cmd) moved a separate batch file (autoupdate.bat) to the Startup folder", "DetectionCategories": [{"Telemetry ": "Telemetry showed filemods indicating the creation and file write of autoupdate.bat to the Startup folder."}, {" Enrichment": " The capability enriched cmd.exe with the correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)."}], "Screenshots": {"CB-1.B.1-1.png": "Telemetry showing filemods indicating update.bat was written to the Startup folder", "CB-1.B.1-2.png": "Enrichment of cmd.exe with correct ATT&CK Technique (T1060 - Registry Run Keys/Start Folder)", "": ""}}, "10.A.1": {"Procedure": "Batch file (autoupdate.bat) previously written to Startup folder executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (update.dat) using Rundll32", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed cmd.exe executing autoupdate.bat from the Startup folder."}], "Screenshots": {"CB-10.A.1-1.png": "Telemetry from process tree showing cmd.exe executing autoupdate.bat from Startup folder", "": ""}}}}, "T1043": {"TechniqueName": "Commonly Used Port", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using port 53", "DetectionCategories": [{"Telemetry ": "Telemetry showed a network connection over UDP port 53."}], "Screenshots": {"CB-6.B.1-3.png": "Telemetry showing network connection over UDP port 53", "": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use port 80", "DetectionCategories": [{"Telemetry ": "Telemetry showed network connections over TCP port 80 to 192.168.0.4 (C2 server)."}, {" Enrichment": " The capability enriched the network connections from rundll32.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port)."}], "Screenshots": {"CB-6.B.1-2.png": "Telemetry showing network connection over port 80 to 192.168.0.4 (C2 server)", "CB-6.B.1-4.png": "Enrichment of rundll32.exe TCP port 80 network connections with correct ATT&CK Technique (T1043 - Commonly Used Port)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using port 443", "DetectionCategories": [{"Enrichment ": "The capability enriched backgroundtaskhost.exe and powershell.exe with the correct ATT&CK Technique (T1043 - Commonly Used Port)."}, {" Telemetry": "Telemetry showed network connections, including over TCP port 443 to www.freegoogleadsenseinfo.com (C2 domain)."}], "Screenshots": {"CB-11.A.1-1.png": "Enrichment of backgroundtaskhost.exe and powershell.exe with correct ATT&CK Technique (T1043 - Commonly Used Port)", "CB-11.B.1-1.png": "Telemetry showing network connections, including over TCP port 443", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over port 8080", "DetectionCategories": [{"Telemetry": "Telemetry showed network connection to 192.168.0.5 (C2 server) over TCP port 8080."}], "Screenshots": {"CB-14.A.1-3.png": "Telemetry showing network connection to 192.168.0.5 (C2 server) over TCP port 8080", "": ""}}}}, "T1071": {"TechniqueName": "Standard Application Layer Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using DNS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to use HTTP traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry": "Telemetry showed network connections over TCP port 80 as well as a modload showing winhttp.dll was loaded, which an analyst could use to determine HTTP was used."}], "Screenshots": {"CB-6.B.1-8.png": "Telemetry showing modloads showing winhttp.dll loaded", "CB-6.B.1-2.png": "Telemetry showing network connection over TCP port 80 to the C2 domain (could be used in conjunction with modload to determine protocol)", "": ""}}, "11.B.1": {"Procedure": "Empire: C2 channel established using HTTPS traffic to freegoogleadsenseinfo.com", "DetectionCategories": [{"Telemetry": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used."}], "Screenshots": {"CB-11.B.1-2.png": "Telemetry showing modloads and certificate check", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded a new Empire stager (wdbypass) over HTTP", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1132": {"TechniqueName": "Data Encoding", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"1.C.1": {"Procedure": "Cobalt Strike: C2 channel established using both NetBIOS and base64 encoding", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1059": {"TechniqueName": "Command-Line Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.E.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.F.3": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "2.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "4.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "6.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "7.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.F.1": {"Procedure": "Empire: Built-in runas module executed to launch malicious VBScript (autoupdate.vbs) as user Kmitnick\u00a0", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree with cmd.exe execution and associated user context change."}, {" Enrichment ": "The capability enriched cmd.exe event data with the correct ATT&CK Technique (T1059 - Command-Line Interface)."}], "Screenshots": {"CB-16.F.1-1.png": "Telemetry showing process tree with cmd.exe and initial powershell.exe running as user Bob", "CB-16.F.1-2.png": "Telemetry showing process tree with cmd.exe and final powershell.exe running as user Kmitnick", "CB-16.F.1-3.png": "Enrichment of cmd.exe event with correct ATT&CK Technique (T1059 - Command-Line Interface)", "": ""}}}}, "T1016": {"TechniqueName": "System Network Configuration Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.A.1": {"Procedure": "Cobalt Strike: 'ipconfig /all' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing ipconfig.exe with command-line arguments."}, {" Enrichment": "The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1016 - System Network Configuration Discovery)."}], "Screenshots": {"CB-2.A.1-1.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments", "CB-2.A.1-2.png": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1016 - System Network Configuration Discovery)", "": ""}}, "2.A.2": {"Procedure": "Cobalt Strike: 'arp -a' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing arp.exe with command-line arguments."}, {" Enrichment": "The capability enriched arp.exe with a related ATT&CK Technique (T1018 - Remote System Discovery)."}], "Screenshots": {"CB-2.A.2-1.png": "Telemetry from process tree showing arp.exe with command-line arguments", "CB-2.A.2-2.png": "Enrichment of arp.exe with related ATT&CK Technique (T1018 - Remote System Discovery)", "": ""}}, "4.B.1": {"Procedure": "Cobalt Strike: 'netsh advfirewall show allprofiles' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing netsh.exe with command-line arguments."}, {" Enrichment": "The capability enriched netsh.exe with a related ATT&CK technique (T1063 - Security Software Discovery) and a tag for Potential Windows Firewall Rule Recon."}], "Screenshots": {"CB-4.B.1-1.png": "Telemetry from process tree showing netsh.exe with command-line arguments", "CB-4.B.1-2.png": "Enrichment of netsh.exe with related ATT&CK technique (T1063 - Security Software Discovery) and tag for Potential Windows Firewall Rule Recon", "": ""}}, "12.A.1": {"Procedure": "Empire: 'route print' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed powershell.exe executing route.exe with command-line arguments."}], "Screenshots": {"CB-12.A.1-2.png": "Telemetry from process tree showing route.exe with command-line arguments", "": ""}}, "12.A.2": {"Procedure": "Empire: 'ipconfig /all' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing ipconfig.exe with command-line arguments."}, {" Enrichment": " The capability enriched ipconfig.exe with the correct ATT&CK Technique (T1049 - System Network Configuration Discovery)."}], "Screenshots": {"CB-12.A.2-1.png": "Telemetry from process tree showing ipconfig.exe with command-line arguments", "CB-12.A.1-1.png": "Enrichment of ipconfig.exe with correct ATT&CK Technique (T1049 - System Network Configuration Discovery)", "": ""}}, "12.E.1.11": {"Procedure": "Empire: WinEnum module included enumeration of network adapters", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1033": {"TechniqueName": "System Owner/User Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.B.1": {"Procedure": "Cobalt Strike: 'echo' via cmd to enumerate specific environment variables", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed cmd.exe executing echo with command-line arguments."}], "Screenshots": {"CB-2.B.1-1.png": "Telemetry from process tree showing echo with command-line arguments", "": ""}}, "12.B.1": {"Procedure": "Empire: 'whoami /all /fo list' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing whoami.exe with command-line arguments."}, {" Enrichment": " The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery)."}], "Screenshots": {"CB-12.B.1-1.png": "Telemetry from process tree showing whoami.exe with command-line arguments", "CB-12.B.1-2.png": "Enrichment of whoami.exe with correct ATT&CK Technique (T1033 - System Owner/User Discovery)", "": ""}}, "12.E.1.1": {"Procedure": "Empire: WinEnum module included enumeration of user information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "20.B.1": {"Procedure": "Executed 'whoami' via cmd persistence mechanism through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed magnify.exe executing whoami.exe. "}, {" Enrichment": " The capability enriched whoami.exe with the correct ATT&CK Technique (T1033 - System Owner/User Discovery).\u00a0"}], "Screenshots": {"CB-20.B.1-1.png": "Telemetry from process tree with telemetry showing whoami.exe execution", "CB-20.B.1-2.png": "Enrichment of whoami.exe\u00a0with correct ATT&CK Technique (T1033 - System Owner/User Discovery)", "": ""}}}}, "T1106": {"TechniqueName": "Execution through API", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"2.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "3.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "8.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "9.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1057": {"TechniqueName": "Process Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.C.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "2.C.2 ": {"Procedure": "Cobalt Strike: 'tasklist /v' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing tasklist.exe with command-line arguments."}, {" Enrichment": "The capability enriched tasklist.exe with the correct ATT&CK Technique (T1057 - Process Discovery)."}], "Screenshots": {"CB-2.C.2-1.png": "Telemetry from process tree showing tasklist.exe with command-line arguments", "CB-2.C.2-2.png": "Enrichment of tasklist.exe with correct ATT&CK Technique (T1057 - Process Discovery)", "": ""}}, "3.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "8.B.1": {"Procedure": "Cobalt Strike: 'ps' (Process status) via Win32 APIs", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "Empire: 'qprocess *' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing qprocess.exe with command-line arguments."}, {" Enrichment": " The capability enriched qprocess.exe with the correct ATT&CK Technique (Process Discovery)."}], "Screenshots": {"CB-12.C.1-1.png": "Telemetry from process tree showing qprocess.exe with command-line arguments", "CB-12.C.1-2.png": "Enrichment of qprocess.exe with correct ATT&CK Technique (Process Discovery)", "": ""}}}}, "T1007": {"TechniqueName": "System Service Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.D.1": {"Procedure": "Cobalt Strike: 'sc query' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing sc.exe with command-line arguments."}, {" Enrichment": "The capability enriched sc.exe with the correct ATT&CK Technique (System Service Discovery)."}], "Screenshots": {"CB-2.A-ALL.png": "Telemetry from process tree showing sc.exe with command-line arguments", "CB-2.D.1-1.png": "Enrichment of sc.exe with correct ATT&CK Technique (System Service Discovery)", "": ""}}, "2.D.2": {"Procedure": "Cobalt Strike: 'net start' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (System Service Discovery)."}], "Screenshots": {"CB-2.D.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.D.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (System Service Discovery)", "": ""}}, "12.D.1": {"Procedure": "Empire: 'net start' via PowerShell", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments."}], "Screenshots": {"CB-12.A.D.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "": ""}}, "12.E.1.8": {"Procedure": "Empire: WinEnum module included enumeration of services", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "Empire: 'sc query' via PowerShell to remotely enumerate services on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to remotely query services on Creeper. Telemetry also showed module loads and a network connection to Creeper (10.0.0.4). "}, {" Enrichment ": " The capability enriched the sc.exe execution with the correct ATT&CK Technique (System Service Discovery)."}], "Screenshots": {"CB-16.H.1-1.png": "Telemetry from process tree showing sc.exe execution for the service query", "CB-16.H.1-2.png": "Telemetry showing module loads from execution of sc.exe to remotely query services on Creeper (10.0.0.4)", "CB-16.H.1-3.png": "Enrichment of sc.exe executing to query services with correct ATT&CK Technique (System Service Discovery)", "": ""}}, "16.J.1": {"Procedure": "Empire: 'sc qc' via PowerShell to remotely enumerate a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to query the AdobeUpdater service on Creeper. "}, {" Enrichment ": " The capability enriched sc.exe execution with the correct ATT&CK Technique (System Service Discovery)."}], "Screenshots": {"CB-16.J.1-1.png": "Telemetry from process tree showing sc.exe execution to query the AdobeUpdater service on Creeper", "CB-16.H.1-3.png": "Enrichment of sc.exe executing query services with correct ATT&CK Technique (System Service Discovery)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key associated with terminal services", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed reg.exe executing with command-line arguments to check if terminal services were enabled. "}], "Screenshots": {"CB-17.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "": ""}}}}, "T1082": {"TechniqueName": "System Information Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.E.1": {"Procedure": "Cobalt Strike: 'systeminfo' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing systeminfo.exe."}, {" Enrichment": "The capability enriched systeminfo.exe with the correct ATT&CK Technique (System Information Discovery)."}], "Screenshots": {"CB-2.E.1-1.png": "Telemetry from process tree showing systeminfo.exe", "CB-2.E.1-2.png": "Enrichment of systeminfo.exe with correct ATT&CK Technique (System Information Discovery)", "": ""}}, "2.E.2": {"Procedure": "Cobalt Strike: 'net config workstation' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (System Information Discovery)."}], "Screenshots": {"CB-2.E.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.E.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (System Information Discovery)", "": ""}}, "12.E.1.6.1": {"Procedure": "Empire: WinEnum module included enumeration of system information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.6.2": {"Procedure": "Empire: WinEnum module included enumeration of Windows update information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1069": {"TechniqueName": "Permission Groups Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.F.1": {"Procedure": "Cobalt Strike: 'net localgroup administrators' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration."}], "Screenshots": {"CB-2.F.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.F.1-2.png": "Enrichment of net.exe with tag Administrator Enumeration", "CB-2.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)", "": ""}}, "2.F.2": {"Procedure": "Cobalt Strike: 'net localgroup administrators /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration."}], "Screenshots": {"CB-2.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.F.2-2.png": "Enrichment of net.exe with tag Administrator Enumeration", "CB-2.F.2-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)", "": ""}}, "2.F.3": {"Procedure": "Cobalt Strike: 'net group \"Domain Admins\" /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (Permission Groups Discovery) as well as the tag Administrator Enumeration."}], "Screenshots": {"CB-2.F.3-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.F.3-2.png": "Enrichment of net.exe with tag Administrator Enumeration", "CB-2.F.3-3.png": "Enrichment of net.exe with correct ATT&CK Technique (Permission Groups Discovery)", "": ""}}, "12.E.1.2": {"Procedure": "Empire: WinEnum module included enumeration of AD group memberships", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "Empire: 'net group \"Domain Admins\" /domain' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments."}, {" Enrichment": " The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery)."}], "Screenshots": {"CB-12.F.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)", "": ""}}, "12.F.2": {"Procedure": "Empire: 'net\u00a0localgroup\u00a0administrators' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments."}, {" Enrichment": " The capability enriched net.exe with the correct ATT&CK Technique (T1069 - Permission Groups Discovery)."}], "Screenshots": {"CB-12.F.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with correct ATT&CK Technique (T1069 - Permission Groups Discovery)", "": ""}}}}, "T1087": {"TechniqueName": "Account Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.G.1": {"Procedure": "Cobalt Strike: 'net user /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery)."}], "Screenshots": {"CB-2.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.G.1-2.png": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)", "": ""}}, "2.G.2": {"Procedure": "Cobalt Strike: 'net user george /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with the correct ATT&CK Technique (Account Discovery)."}], "Screenshots": {"CB-2.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-2.G.2-2.png": "Enrichment of net.exe with correct ATT&CK Technique (Account Discovery)", "": ""}}, "7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility displayed user account information", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the lusrmgr.msc (Local Users and Groups snap-in) which displays local account information."}], "Screenshots": {"CB-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.msc", "": ""}}, "12.G.1": {"Procedure": "Empire: 'net user' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments."}, {" Enrichment": " The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery)."}], "Screenshots": {"CB-12.G.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)", "": ""}}, "12.G.2": {"Procedure": "Empire: 'net user /domain' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed powershell.exe executing net.exe with command-line arguments."}, {" Enrichment": " The capability enriched net.exe with a related ATT&CK Technique (T1069 - Permission Groups Discovery)."}], "Screenshots": {"CB-12.G.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-12.F.1-3.png": "Enrichment of net.exe with related ATT&CK Technique (T1069 - Permission Groups Discovery)", "": ""}}}}, "T1012": {"TechniqueName": "Query Registry", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"2.H.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing reg.exe with command-line arguments."}, {" Enrichment": "The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry)."}], "Screenshots": {"CB-2.H.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "CB-2.H.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)", "": ""}}, "6.A.1": {"Procedure": "Cobalt Strike: 'reg query' via cmd to remotely enumerate a specific Registry key on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry ": "Telemetry showed cmd.exe executing reg.exe with command-line arguments."}, {" Enrichment": " The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry)."}], "Screenshots": {"CB-6.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "CB-6.A.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)", "": ""}}, "12.E.1.7": {"Procedure": "Empire: WinEnum module included enumeration of system information via a Registry query", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "Empire:\u00a0'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing reg.exe with command-line arguments. "}, {" Enrichment": " The capability enriched reg.exe data with the correct ATT&CK Technique (Query Registry)."}], "Screenshots": {"CB-13.C.1-1.png": "Telemetry showing process tree with reg.exe and command-line arguments", "CB-13.C.1-2.png": "Enrichment of reg.exe event with correct ATT&CK Technique (Query Registry)", "": ""}}, "17.A.1": {"Procedure": "Empire: 'reg query' via PowerShell to enumerate a specific Registry key", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed reg.exe executing with command-line arguments. "}, {" Enrichment ": " The capability enriched reg.exe with the correct ATT&CK Technique (T1012 - Query Registry)."}], "Screenshots": {"CB-17.A.1-1.png": "Telemetry from process tree showing reg.exe with command-line arguments", "CB-17.A.1-2.png": "Enrichment of reg.exe with correct ATT&CK Technique (T1012 - Query Registry)", "": ""}}}}, "T1134": {"TechniqueName": "Access Token Manipulation", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to modify current process token", "DetectionCategories": [{"Telemetry": "Telemetry showed svchost.exe, with the seclogon command-line argument, performing activity related to token manipulation."}], "Screenshots": {"CB-3.A.1-6.png": "Telemetry showing svchost.exe command line arguments, specifically seclogon", "CB-3.A.1-5.png": "Telemetry showing svchost.exe activity related to token manipulation", "": ""}}, "5.B.1": {"Procedure": "Cobalt Strike: Built-in token theft capability executed to change user context to George", "DetectionCategories": [{"Telemetry": "Telemetry showed a change in user execution context from Debbie to George between parent and child processes, which is indicative of token manipulation."}], "Screenshots": {"CB-5.B.1-2.png": "Telemetry showing parent cmd.exe process running under user context Debbie", "CB-5.B.1-3.png": "Telemetry showing child cmd.exe process running under user context George", "": ""}}}}, "T1088": {"TechniqueName": "Bypass User Account Control", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.A.1": {"Procedure": "Cobalt Strike: Built-in UAC bypass token duplication capability executed to elevate process integrity level", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "14.A.1": {"Procedure": "Empire: Built-in UAC bypass token duplication module executed to launch new callback with elevated process integrity level", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1055": {"TechniqueName": "Process Injection", "TacticGroup": "Defense Evasion, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"3.C.1": {"Procedure": "Cobalt Strike: Built-in process injection capability executed to inject callback into cmd.exe", "DetectionCategories": [{"Telemetry ": "Telemetry showed \\\"crossproc\\\" events indicative of Process Injection into cmd.exe."}, {" Specific Behavior": " A Specific Behavior alert was generated that was mapped to correct ATT&CK Technique (Process Injection)."}], "Screenshots": {"CB-3.C.1-2.png": "Telemetry showing open handles and thread injection into cmd.exe", "CB-3.C.1-3.png": "Telemetry showing CreateRemoteThread API call used for thread injection into cmd.exe", "CB-3.C.1-1.png": "Specific Behavior alert mapped to correct ATT&CK Technique (T1055 - Process Injection)", "": ""}}, "5.A.1": {"Procedure": "Cobalt Strike: Credential dump capability involved process injection into lsass", "DetectionCategories": [{"Telemetry": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection."}], "Screenshots": {"CB-5.A.1-1.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe", "": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Hash dump capability involved process injection into lsass.exe", "DetectionCategories": [{"Telemetry ": "Telemetry showed a new thread and open handle into lsass.exe, which is indicative of process injection for credential dumping."}, {" Specific Behavior": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping)."}], "Screenshots": {"CB-5.A.2-2.png": "Telemetry showing cross process events, specifically a new thread and open handle into lsass.exe", "CB-5.A.2-4.png": "Specific Behavior alert showing correct ATT&CK Technique (Process Injection)", "CB-5.A.2-1.png": "Alert showing correct ATT&CK Technique (Process Injection) within process tree", "": ""}}, "8.D.1": {"Procedure": "Cobalt Strike: Screen capture capability involved process injection into explorer.exe", "DetectionCategories": [{"Telemetry": "Telemetry showed a cross-process \\\"open handle\\\" event into explorer.exe, which could be indicative of process injection."}], "Screenshots": {"CB-8.D.1-1.png": "Telemetry showing \\\"open handle\\\" crossproc on explorer.exe by the process", "": ""}}}}, "T1018": {"TechniqueName": "Remote System Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.A.1": {"Procedure": "Cobalt Strike: 'net group \"Domain Controllers\" /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery)."}], "Screenshots": {"CB-4.A.1-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-4.A.1-2.png": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)", "": ""}}, "4.A.2": {"Procedure": "Cobalt Strike: 'net group \"Domain Computers\" /domain' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing net.exe with command-line arguments."}, {" Enrichment": "The capability enriched net.exe with a related ATT&CK technique (Account Discovery)."}], "Screenshots": {"CB-4.A.2-1.png": "Telemetry from process tree showing net.exe with command-line arguments", "CB-4.A.2-2.png": "Enrichment of net.exe with related ATT&CK technique (Account Discovery)", "": ""}}, "13.A.1": {"Procedure": "Empire: 'net group \"Domain Computers\" /domain' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing net.exe with command-line arguments. "}, {" Enrichment": " The capability enriched net.exe with a related ATT&CK Technique (Account Discovery)."}], "Screenshots": {"CB-13.A.1-1.png": "Telemetry showing process tree with net.exe and command-line arguments", "CB-13.A.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)", "": ""}}}}, "T1049": {"TechniqueName": "System Network Connections Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"4.C.1": {"Procedure": "Cobalt Strike: 'netstat -ano' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed cmd.exe executing netstat.exe with command-line arguments."}, {" Enrichment": "The capability enriched netstat.exe with the correct ATT&CK technique (System Network Connections Discovery)."}], "Screenshots": {"CB-4.C.1-1.png": "Telemetry from process tree showing netstat.exe with command-line arguments", "CB-4.C.1-2.png": "Enrichment of netstat.exe with correct ATT&CK technique (System Network Connections Discovery)", "": ""}}, "12.E.1.12": {"Procedure": "Empire: WinEnum module included enumeration of established network connections", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed netstat.exe executing with command-line arguments."}, {" Enrichment": " The capability enriched netstat.exe with the correct ATT&CK Technique (System Network Connections Discovery)."}], "Screenshots": {"CB-12.E.1.12-2.png": "Telemetry from process tree showing netstat.exe with command-line arguments", "CB-12.E.1.12-1.png": "Enrichment of netstat.exe with correct ATT&CK Technique (System Network Connections Discovery)", "": ""}}, "13.B.1": {"Procedure": "Empire: 'net use' via PowerShell", "DetectionCategories": [{"Enrichment ": "The capability enriched net.exe with a related ATT&CK Technique (Account Discovery)."}, {" Telemetry": "The vendor demonstrated to MITRE that the capability can provide telemetry of net.exe, but no screenshot was captured for this procedure."}], "Screenshots": {"CB-13.A.1-2.png": "Enrichment of net.exe with related ATT&CK Technique (Account Discovery)", "": ""}}, "13.B.2": {"Procedure": "Empire: 'netstat -ano' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing netstat.exe with command-line arguments. "}, {" Enrichment": " The capability enriched net.exe data with the correct ATT&CK Technique (T1049 - System Network Connections Discovery)."}], "Screenshots": {"CB-13.B.1-1.png": "Telemetry showing process tree with netstat.exe and command-line arguments", "CB-13.A.1-2.png": "Enrichment of netstat.exe with correct ATT&CK Technique (T1049 - System Network Connections Discovery)", "": ""}}}}, "T1003": {"TechniqueName": "Credential Dumping", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"5.A.1": {"Procedure": "Cobalt Strike: Built-in Mimikatz credential dump capability executed", "DetectionCategories": [{"Telemetry ": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping."}, {" Specific Behavior": "A Specific Behavior alert was generated showing the correct ATT&CK Technique (Credential Dumping)."}], "Screenshots": {"CB-5.A.1-1.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe", "CB-5.A.1-4.png": "Specific Behavior alert showing correct ATT&CK Technique (Credential Dumping)", "": ""}}, "5.A.2": {"Procedure": "Cobalt Strike: Built-in hash dump capability executed", "DetectionCategories": [{"Telemetry": "Telemetry showed an open handle to a thread into lsass.exe, which is indicative of process injection for credential dumping."}], "Screenshots": {"CB-5.A.2-2.png": "Telemetry showing cross process events, specifically a handle to open thread into lsass.exe", "": ""}}}}, "T1026": {"TechniqueName": "Multiband Communication", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"6.B.1": {"Procedure": "Cobalt Strike: C2 channel modified to split communications between both HTTP and DNS", "DetectionCategories": [{"Telemetry ": "Telemetry showed separate network connections over port TCP port 80 and UDP port 53, which could indicate multiband communication."}], "Screenshots": {"CB-6.B.1-2.png": "Telemetry showing network connection over TCP port 80", "CB-6.B.1-3.png": "Telemetry showing network connection over UDP port 53", "": ""}}}}, "T1076": {"TechniqueName": "Remote Desktop Protocol", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"6.C.1": {"Procedure": "Cobalt Strike: C2 channel modified to proxy RDP connection to Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry ": "Telemetry showed a connection to 10.0.0.5 (Conficker) over TCP port 3389 as well as rdpclip.exe executing."}, {" Enrichment": " The capability enriched the rdpclip.exe events with the correct ATT&CK Technique (Remote Desktop Protocol)."}], "Screenshots": {"CB-6.B.1-1.png": "Telemetry showing network connection over TCP port 3389 to 10.0.0.5 (Conficker)", "CB-6.C.1-3.png": "Telemetry showing rdpclip.exe running", "CB-6.C.1-1.png": "Enrichment of rdpclip.exe events with correct ATT&CK Technique (Remote Desktop Protocol)", "": ""}}, "10.B.1": {"Procedure": "RDP connection made to Conficker (10.0.0.5) as part of execution of persistence mechanism", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection."}, {" Enrichment": " The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol)."}], "Screenshots": {"CB-10.B.1-1.png": "Telemetry from process tree showing rdpclip.exe running as user Jesse", "CB-10.B.1-2.png": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)", "": ""}}, "20.A.1": {"Procedure": "RDP connection made to Creeper (10.0.0.4) as part of execution of persistence mechanism", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1136": {"TechniqueName": "Create Account", "TacticGroup": "Persistence", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Added user Jesse to Conficker (10.0.0.5) through RDP connection", "DetectionCategories": [{"Telemetry ": "Telemetry showed Registry modification events related to the creation of the user account Jesse."}, {" Enrichment, Configuration Change": "The capability enriched lsass.exe with the tag \\\"Create Accounts using GUI\\\". [CB1]"}], "Screenshots": {"CB-7.A.1-2.png": "Telemetry showing Registry modifications for new user Jesse", "CB-7.A.1-4.png": "Enrichment of lsass.exe with tag \\\"Create Accounts using GUI\\\"", "": ""}}}}, "T1061": {"TechniqueName": "Graphical User Interface", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"7.A.1": {"Procedure": "Microsoft Management Console (Local Users and Groups snap-in) GUI utility used to add new user through RDP connection", "DetectionCategories": [{"Telemetry": "Telemetry showed execution of mmc.exe, the Microsoft Management Console, spawning the GUI-based lusrmgr.msc (Local Users and Groups snap-in)."}], "Screenshots": {"CB-7.A.1-3.png": "Telemetry showing mmc.exe running lusrmgr.msc", "": ""}}}}, "T1105": {"TechniqueName": "Remote File Copy", "TacticGroup": "Command and Control, Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"7.B.1": {"Procedure": "Cobalt Strike: Built-in upload capability executed to write a DLL payload (updater.dll) to disk on Nimda (10.0.1.6)", "DetectionCategories": [{"Telemetry": "Telemetry showed file modification events indicating updater.dll being created and written to disk."}], "Screenshots": {"CB-7.B.1-1.png": "Telemetry showing updater.dll written to disk", "": ""}}, "14.A.1": {"Procedure": "Empire: UAC bypass module downloaded and wrote a new Empire stager (wdbypass) to disk", "DetectionCategories": [{"Telemetry": "The vendor demonstrated to MITRE that the capability can provide telemetry of network connections and file modifications indicating a Remote File Copy, but no screenshot was captured for this procedure."}], "Screenshots": {"": ""}}, "16.E.1": {"Procedure": "Empire: Built-in upload module executed to write malicious VBScript (autoupdate.vbs) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed filemods showing the creation and writing to autoupdate.vbs. "}], "Screenshots": {"CB-16.E.1-1.png": "Telemetry showing creation and write to autoupdate.vbs", "": ""}}, "16.G.1": {"Procedure": "Empire: Built-in move capability executed to write malicious VBScript (update.vbs) to disk on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry showed filemods showing the creation and writing to update.vbs on remote host 10.0.0.4 (Creeper)."}], "Screenshots": {"CB-16.G.1-1.png": "Telemetry showing remote creation and write to update.vbs", "": ""}}, "19.A.1": {"Procedure": "Empire: Built-in upload module executed to write binary (recycler.exe) to disk on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry": "Telemetry showed the creation of recycler.exe.\u00a0"}], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing filemod (file modification) creation of recycler.exe", "": ""}}}}, "T1053": {"TechniqueName": "Scheduled Task", "TacticGroup": "Execution, Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"7.C.1": {"Procedure": "Cobalt Strike: 'schtasks' via cmd to create scheduled task that executes a DLL payload (updater.dll)", "DetectionCategories": [{"Telemetry ": "Telemetry showed the process tree containing schtasks.exe as well as the full command-line arguments."}, {" Specific Behavior": " A Specific Behavior alert was generated mapped to the correct ATT&CK Technique (T1053 - Scheduled Task)."}], "Screenshots": {"CB-7.C.1-1.png": "Telemetry showing process tree containing schtasks.exe and full command a task creation", "CB-7.C.1-2.png": "Specific Behavior alert mapped to correct ATT&CK Technique (T1053 - Scheduled Task)", "": ""}}, "10.A.2": {"Procedure": "Scheduled task executed when user Debbie logs on to Nimda (10.0.1.6), launching a DLL payload (updater.dll) using Rundll32", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed rundll32.exe executing updater.dll with a parent of svchost.exe running with command-line arguments \\\"-k netsvcs -p -s Schedule\\\"."}], "Screenshots": {"CB-10.A.2-1.png": "Telemetry from process tree showing svchost.exe parent of rundll32.exe process running with \\\"-k netsvcs -p -s Schedule\\\" arguments", "CB-10.A.2-2.png": "Telemetry from process tree showing updater.dll executed by rundll32.exe", "": ""}}}}, "T1083": {"TechniqueName": "File and Directory Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.A.1": {"Procedure": "Cobalt Strike: 'dir /s /b \"\\\\conficker\\wormshare\"' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry showed cmd.exe executing dir with command-line arguments."}, {" Enrichment": " The capability enriched cmd.exe with the correct ATT&CK Technique (T1083 - File and Directory Discovery)."}], "Screenshots": {"CB-8.A.1-1.png": "Telemetry from process tree showing dir with command-line arguments", "CB-8.C.1-2.png": "Enrichment of cmd.exe with correct ATT&CK Technique (T1083 - File and Directory Discovery)", "": ""}}, "8.A.2": {"Procedure": "Cobalt Strike: 'tree \"C:\\Users\\debbie\"' via cmd", "DetectionCategories": [{"Telemetry ": "Telemetry showed cmd.exe executing tree.com with command-line arguments."}, {" Enrichment": " The capability enriched tree.com with the correct ATT&CK Technique (T1083 - File and Directory Discovery)."}], "Screenshots": {"CB-8.A.1-2.png": "Telemetry from process tree showing tree.com with command-line arguments", "CB-8.C.1-2.png": "Enrichment of tree.com with correct ATT&CK Technique (T1083 - File and Directory Discovery)", "": ""}}, "9.A.1": {"Procedure": "Cobalt Strike: 'ls' (List) via Win32 APIs to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.1": {"Procedure": "Empire: WinEnum module included enumeration of recently opened files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.4.2": {"Procedure": "Empire: WinEnum module included enumeration of interesting files", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "Empire: 'type' via PowerShell to remotely enumerate a specific file (update.vbs) on Creeper (10.0.0.4)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "Empire: 'Get-ChildItem' via PowerShell to enumerate a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1056": {"TechniqueName": "Input Capture", "TacticGroup": "collection, Credential Access", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Built-in keylogging capability executed to capture keystrokes of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure.[CB2]"}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module executed to capture keystrokes of user Bob", "DetectionCategories": [{"Telemetry ": "Telemetry showed modloads associated with the execution of a keylogger. "}, {" Enrichment": " The capability enriched the events with a tag titled \\\"PowerShell Input Capture -keylogger\\\" based on known modloads that could be potentially abused to provide keylogger functionality."}], "Screenshots": {"CB-15.A.1-1.png": "Telemetry showing modloads associated with keylogger", "CB-15.A.1-3.png": "Enrichment of data with tag \\\"PowerShell Input Capture -keylogger\\\"", "": ""}}}}, "T1010": {"TechniqueName": "Application Window Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"8.C.1": {"Procedure": "Cobalt Strike: Keylogging capability included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "15.A.1": {"Procedure": "Empire: Built-in keylogging module included residual enumeration of application windows", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1113": {"TechniqueName": "Screen Capture", "TacticGroup": "Collection", "PrimaryEnabling": "Primary", "Steps": {"8.D.1": {"Procedure": "Cobalt Strike: Built-in screen capture capability executed to capture screenshot of current window of user Debbie", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure, though modloads showed the thumbnail com object masquerading followed by a modload of dwmapi.dll (Microsoft Desktop Windows Manager API) and then a crossprocess (open process) to the target application, which could be indicative of screen capture behavior."}], "Screenshots": {"CB-8.D.1-1.png": "Telemetry showing modloads and crossprocess events (does not count as a detection)", "": ""}}}}, "T1039": {"TechniqueName": "Data from Network Shared Drive", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Built-in download capability executed to a collect file (Shockwave_rackb_diagram.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "Empire: 'copy' via PowerShell collected a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure.[CB90]\u00a0"}], "Screenshots": {"": ""}}}}, "T1041": {"TechniqueName": "Exfiltration Over Command and Control Channel", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"9.B.1": {"Procedure": "Cobalt Strike: Download capability exfiltrated data through existing C2 channel", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1078": {"TechniqueName": "Valid Accounts", "TacticGroup": "Defense Evasion, Persistence, Privilege Escalation, Initial Access", "PrimaryEnabling": "Primary", "Steps": {"10.B.1": {"Procedure": "RDP connection to Conficker (10.0.0.5) authenticated using previously added user Jesse", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed rdpclip.exe execution by the user Jesse on the destination system of the RDP connection."}, {" Enrichment": " The capability enriched rdpclip.exe with the correct ATT&CK Technique (Remote Desktop Protocol)."}], "Screenshots": {"CB-10.B.1-1.png": "Telemetry from process tree showing rdpclip.exe running as user Jesse", "CB-10.B.1-2.png": "Enrichment of rdpclip.exe with correct ATT&CK Technique (Remote Desktop Protocol)", "": ""}}, "16.B.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Conficker (10.0.0.5) using credentials of user Kmitnick", "DetectionCategories": [{"Telemetry": "Telemetry showed a process tree containing a successful logon via net.exe."}], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts, including a success", "CB-16.B.1-2.png": "Telemetry showing successful logon via net.exe", "": ""}}, "16.D.1": {"Procedure": "Empire: 'net use' via PowerShell to successfully authenticate to Creeper (10.0.0.4) using credentials of user Kmitnick", "DetectionCategories": [{"Telemetry": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments using valid account credentials."}], "Screenshots": {"CB-16.D.1-1.png": "Telemetry showing process tree with logon using valid account credentials", "": ""}}}}, "T1086": {"TechniqueName": "PowerShell", "TacticGroup": "Execution", "PrimaryEnabling": "Enabling", "Steps": {"11.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.A.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.E.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.F.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "12.G.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "13.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "15.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.H.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.I.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.J.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.K.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "16.L.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.B.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "17.C.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.A.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "18.B.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.1": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}, "19.D.2": {"Procedure": "", "DetectionCategories": [{"": ""}], "Screenshots": {"": ""}}}}, "T1032": {"TechniqueName": "Standard Cryptographic Protocol", "TacticGroup": "Command and Control", "PrimaryEnabling": "Primary", "Steps": {"11.B.1": {"Procedure": "Empire: Encrypted C2 channel established using HTTPS", "DetectionCategories": [{"Telemetry": "Telemetry showed modload events importing dynamic libraries usually used for HTTP and SSL communication (e.g. winhttp.dll), followed by a CRL check to a CA, indicating that HTTPS was likely used."}], "Screenshots": {"CB-11.B.1-2.png": "Telemetry showing modloads and certificate check", "": ""}}}}, "T1201": {"TechniqueName": "Password Policy Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.3": {"Procedure": "Empire: WinEnum module included enumeration of password policy information", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1115": {"TechniqueName": "Clipboard Data", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.5": {"Procedure": "Empire: WinEnum module included enumeration of clipboard contents", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1135": {"TechniqueName": "Network Share Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.9.1": {"Procedure": "Empire: WinEnum module included enumeration of available shares", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.9.2": {"Procedure": "Empire: WinEnum module included enumeration of mapped network drives", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1063": {"TechniqueName": "Security Software Discovery", "TacticGroup": "Discovery", "PrimaryEnabling": "Primary", "Steps": {"12.E.1.10.1": {"Procedure": "Empire: WinEnum module included enumeration of AV solutions", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}, "12.E.1.10.2": {"Procedure": "Empire: WinEnum module included enumeration of firewall rules", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1081": {"TechniqueName": "Credentials in Files", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"15.B.1": {"Procedure": "Empire: 'get-content' via PowerShell to collect sensitive file (it_tasks.txt) from a network shared drive (Wormshare) on Conficker (10.0.0.5)", "DetectionCategories": [{"None": "No detection capability demonstrated for this procedure."}], "Screenshots": {"": ""}}}}, "T1110": {"TechniqueName": "Brute Force", "TacticGroup": "Credential Access", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: 'net use' via PowerShell to brute force password spraying authentication attempts to Morris (10.0.1.4) and Nimda (10.0.1.6) targeting credentials of users\u00a0Kmitnick, Bob, and Frieda", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying."}, {" Enrichment, Configuration Change": " The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\". [CB8]"}], "Screenshots": {"CB-16.A.1-1.png": "Telemetry showing process tree with four different net.exe logon attempts", "CB-16.B.1-2.png": "Enrichment of the individual net.exe logon attempts with tag \\\"Credential Access using Admin Shares - Failed Attempts\\\"", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication to Conficker (10.0.0.5) using credentials of user Kmitnick as a result of the brute force password spraying", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing repeated logon attempts via net.exe and command-line arguments indicative of password spraying, eventually resulting in a successful logon."}, {" Enrichment, Configuration Change": " The capability enriched individual net.exe events with tagging titled \\\"Credential Access using Admin Shares - Failed Attempts\\\" for failures as well as a related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons. [CB8]"}], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts, including a success", "CB-16.B.1-2.png": "Enrichment of the individual net.exe logon attempts, successful logons mapped to related ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)", "": ""}}}}, "T1077": {"TechniqueName": "Windows Admin Shares", "TacticGroup": "Lateral Movement", "PrimaryEnabling": "Primary", "Steps": {"16.A.1": {"Procedure": "Empire: Brute force password spraying attempts targeted Windows admin shares on Morris (10.0.1.4) and Nimda (10.0.1.6)", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$."}, {" Specific Behavior": " Specific Behavior alerts titled \\\"Windows Admin Shares - Lateral Movement\\\" were generated for credential accesses specifically targeting admin shares."}], "Screenshots": {"CB-16.A.1-1.png": "Telemetry showing process tree with four different net.exe logon attempts targeting ADMIN$", "CB-16.A.1-3.png": "Specific Behavior alerts for of the 4 different net.exe logon attempts", "": ""}}, "16.B.1": {"Procedure": "Empire: Successful authentication targeted Windows admin share on Conficker (10.0.0.5)\u00a0", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing repeated logon attempts via net.exe targeting ADMIN$, eventually resulting in a successful logon."}, {" Specific Behavior": " Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons."}], "Screenshots": {"CB-16.B.1-1.png": "Telemetry showing process tree with five different net.exe logon attempts targeting ADMIN$", "CB-16.B.1-2.png": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)", "": ""}}, "16.D.1": {"Procedure": "Empire: Successful authentication targeted Windows admin shares on Conficker (10.0.0.5)", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing a logon attempt via net.exe and command-line arguments \u00a0targeting C$ using valid account credentials."}, {" Specific Behavior": " \u00a0Specific Behavior alerts were generated mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement) for successful logons."}], "Screenshots": {"CB-16.D.1-1.png": "Telemetry showing process tree with successful net.exe logon targeting C$", "CB-16.D.1-2.png": "Specific Behavior alerts for a successful logon mapped to the correct ATT&CK Technique (T1077 - Windows Admin Shares) and Tactic (Lateral Movement)", "": ""}}}}, "T1126": {"TechniqueName": "Network Share Connection Removal", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.C.1": {"Procedure": "Empire: 'net use /delete' via PowerShell", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree containing net.exe and command-line arguments. "}, {" Specific Behavior": " A Specific Behavior alert was generated indicating that a connected network share was removed."}], "Screenshots": {"CB-16.C.1-1.png": "Telemetry showing process tree with net.exe and command-line arguments", "CB-16.B.1-2.png": "Specific Behavior alerts for removing connected network share", "": ""}}}}, "T1036": {"TechniqueName": "Masquerading", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc description' via PowerShell to remotely disguise a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry within the process trees showed execution of sc.exe with command-line arguments to create the AdobeUpdater service with binPath pointed to cmd.exe with arguments to execute update.vbs and a suspicious service description, which indicates masquerading."}], "Screenshots": {"CB-16.I.1-2.png": "Telemetry from process tree showing sc.exe execution setting the AdobeUpdater service description", "CB-16.I.1-1.png": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service", "": ""}}, "19.A.1": {"Procedure": "Empire: File dropped to disk is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Telemetry": "Telemetry showed the creation of recycler.exe. Binary metadata on recycler.exe indicated it was masquerading and had a digital signature and file metadata that matched the WinRAR utility."}], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing filemod creation of recycler.exe", "CB-19.A.1-2.png": "Binary metadata showing recycler.exe is WinRAR.exe based on digital signature and file version information", "": ""}}, "19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) is a renamed copy of the WinRAR binary", "DetectionCategories": [{"Telemetry ": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. "}, {" Specific Behavior": " A Specific Behavior alert was generated on execution of recycler.exe indicating it was WinRAR and was masquerading as a renamed process."}], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing recycler.exe and command-line arguments with arguments indicating it is WinRAR", "CB-19.B.1-5.png": "Specific Behavior alert for recycler.exe masquerading as a renamed WinRAR process", "": ""}}}}, "T1050": {"TechniqueName": "New Service", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"16.I.1": {"Procedure": "Empire: 'sc create' via PowerShell to remotely create a service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to create a new AdobeUpdater service containing a binPath pointed to cmd.exe with arguments to execute update.vbs. "}, {" Specific Behavior ": " A Specific Behavior alert was generated for sc.exe execution to create the AdobeUpdater service with the correct ATT&CK Technique (New Service)."}], "Screenshots": {"CB-16.I.1-1.png": "Telemetry from process tree showing sc.exe execution creating the AdobeUpdater service", "CB-16.H.1-3.png": "Specific Behavior alert on sc.exe executing to create the AdobeUpdater service mapped to ATT&CK", "": ""}}}}, "T1035": {"TechniqueName": "Service Execution", "TacticGroup": "Execution", "PrimaryEnabling": "Primary", "Steps": {"16.L.1": {"Procedure": "Empire: 'sc start' via PowerShell to remotely launch a specific service on Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry": "Telemetry within the process tree showed execution of sc.exe with command-line arguments to start the AdobeUpdater service on Creeper."}], "Screenshots": {"CB-16.L.1-1.png": "Telemetry from process tree showing sc.exe execution to start the AdobeUpdater service on Creeper", "": ""}}}}, "T1222": {"TechniqueName": "File Permissions Modification", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"17.B.1": {"Procedure": "Empire: 'takeown' via PowerShell to obtain ownership of magnify.exe", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed execution of takeown.exe with command-line arguments on magnify.exe. "}, {" Enrichment, Configuration Change ": " The capability enriched the execution of takeown.exe with \\\"Permission modifications\\\".[CB1]"}], "Screenshots": {"CB-17.B.1-1.png": "Telemetry from process tree showing takeown.exe with command-line arguments", "CB-17.A.1-2.png": "Enrichment of takeown.exe execution with tag \\\"Permission modifications\\\"", "": ""}}, "17.B.2": {"Procedure": "Empire: 'icacls' via PowerShell to modify the DACL for magnify.exe", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree showed execution of icacls.exe with command-line arguments on magnify.exe. "}, {" Enrichment, Configuration Change ": " The capability enriched the execution of icacls.exe with \\\"Permission modifications\\\".[CB1]"}], "Screenshots": {"CB-17.B.2-1.png": "Telemetry from process tree showing icacls.exe with command-line arguments", "CB-17.A.1-2.png": "Enrichment of icacls.exe execution with tag \\\"Permission modifications\\\"", "": ""}}}}, "T1015": {"TechniqueName": "Accessibility Features", "TacticGroup": "Persistence, Privilege Escalation", "PrimaryEnabling": "Primary", "Steps": {"17.C.1": {"Procedure": "Empire: 'copy' via PowerShell to overwrite magnify.exe with cmd.exe", "DetectionCategories": [{"Telemetry ": "Telemetry showed filemod events overwriting magnify.exe in the system directory. "}, {" Specific Behavior": " A Specific Behavior alert was generated for powershell.exe with a severity score of 51/100 when magnify.exe was replaced. The alert was also mapped to the correct ATT&CK Technique (T1015 - Accessibility Features)."}], "Screenshots": {"CB-17.C.1-1.png": "Telemetry showing creation and file write replacing magnify.exe in the system directory", "CB-17.A.1-2.png": "Specific Behavior alert on powershell.exe when it replaced magnify.exe (mapped to correct ATT&CK Technique, T1015 - Accessibility Features)", "": ""}}, "20.A.1": {"Procedure": "magnifer.exe previously overwritten by cmd.exe launched through RDP connection made to Creeper (10.0.0.4)", "DetectionCategories": [{"Telemetry ": "Telemetry within the process tree that showed magnify.exe executing from utilman.exe."}, {" Specific Behavior ": " A Specific Behavior alert was generated on execution of magnify.exe named \\\"Suspicious screen magnifier\u00a0process\\\" with a 76/100 severity score. "}, {" General Behavior ": " A General Behavior alert was generated named \\\"Suspicious renamed cmd process\\\" with a 72/100 severity score. "}, {" General Behavior": " A General Behavior alert was generated named \\\"Execution of cmd from non-standard path\\\" with a 60/100 severity score."}], "Screenshots": {"CB-20.B.1-1.png": "Telemetry from process tree telemetry showing magnify.exe execution", "CB-20.B.1-2.png": "Three alerts (one Specific Behavior and two General Behavior alerts) from execution of magnify.exe\u00a0showing red severity scores", "": ""}}}}, "T1074": {"TechniqueName": "Data Staged", "TacticGroup": "collection", "PrimaryEnabling": "Primary", "Steps": {"18.B.1": {"Procedure": "Empire: 'copy' via PowerShell staged a file (Shockwave_network.vsdx) from a network shared drive (Wormshare) on Conficker (10.0.0.5) in the Recycle Bin (C:\\$Recycle.Bin) on CodeRed (10.0.1.5)", "DetectionCategories": [{"Telemetry ": "Telemetry showed filemod events for the creation and write the .vsdx in the Recycle Bin. "}, {" Specific Behavior": " A Specific Behavior alert was generated with a severity score of 60/100 and was correctly mapped to correct ATT&CK Technique (T1074 - Data Staged)."}], "Screenshots": {"CB-18.B.1-1.png": "Telemetry showing creation of the .vsdx file in the Recycle Bin", "CB-18.B.1-2.png": "Specific Behavior alert on the file write of the .vsdx file in the Recycle Bin (showing red severity score, mapped to correct ATT&CK Technique, T1074 - Data Staged)", "": ""}}}}, "T1002": {"TechniqueName": "Data Compressed", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created compressed archive (old.rar) of previously collected file", "DetectionCategories": [{"Telemetry ": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. Telemetry also showed the creation of old.rar as the output of recycler.exe running."}, {" Enrichment": "The capability enriched recycler.exe with the correct ATT&CK Technique (1002 - Data Compressed)."}], "Screenshots": {"CB-19.B.1-3.png": "Process tree with telemetry showing recycler.exe and command-line arguments", "CB-19.B.1-1.png": "Telemetry showing filemod (file modification) creation of old.rar output of recycler.exe", "CB-19.B.1-2.png": "Enrichment of recycler.exe with correct ATT&CK Technique (1002 - Data Compressed)", "": ""}}}}, "T1022": {"TechniqueName": "Data Encrypted", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.B.1": {"Procedure": "Empire: Executed binary (recycler.exe) created encrypted archive (old.rar) of previously collected file", "DetectionCategories": [{"Telemetry ": "Telemetry showed the execution of recycler.exe with command-line arguments indicating it was WinRAR and file compression and encryption was used to create an encrypted archive. "}, {" Enrichment": "The capability enriched recycler.exe with the correct ATT&CK Technique (1022 - Data Encrypted)."}], "Screenshots": {"CB-19.A.1-1.png": "Telemetry showing recycler.exe and command-line arguments with encryption password", "CB-19.B.1-2.png": "Enrichment of recycler.exe with correct ATT&CK Technique (1022 - Data Encrypted)", "": ""}}}}, "T1048": {"TechniqueName": "Exfiltration Over Alternative Protocol", "TacticGroup": "Exfiltration", "PrimaryEnabling": "Primary", "Steps": {"19.C.1": {"Procedure": "Empire: Sequence of 'echo' commands via PowerShell to populate commands in text file (ftp.txt), which is then executed by FTP to exfil data through network connection separate of existing C2 channel", "DetectionCategories": [{"Telemetry ": "Telemetry showed a process tree for ftp.exe being executed with command-line arguments including ftp.txt. The contents of ftp.txt was not seen. "}, {" Enrichment": " The capability enriched ftp.exe with the correct ATT&CK Technique (Exfil Over Alternate Protocol)."}], "Screenshots": {"CB-19.C.1-1.png": "Telemetry from process tree showing execution of ftp.exe with command-line arguments", "CB-19.C.1-2.png": "Enrichment of ftp.exe with correct ATT&CK Technique (Exfil Over Alternate Protocol)", "": ""}}}}, "T1107": {"TechniqueName": "File Deletion", "TacticGroup": "Defense Evasion", "PrimaryEnabling": "Primary", "Steps": {"19.D.1": {"Procedure": "Empire: 'del C:\\\"$\"Recycle.bin\\old.rar'", "DetectionCategories": [{"Telemetry": "Telemetry showed the deletion of old.rar."}], "Screenshots": {"CB-19.D.1-1.png": "Telemetry showing filemod (file modification) deletion of old.rar", "": ""}}, "19.D.2": {"Procedure": "Empire: 'del recycler.exe'", "DetectionCategories": [{"Telemetry": "Telemetry showed the deletion of recycler.exe."}], "Screenshots": {"CB-19.D.1-1.png": "Telemetry showing filemod (file modification) deletion of recycler.exe", "": ""}}}}}